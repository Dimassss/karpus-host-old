class CustomerProfileDAO extends DAO{constructor(){super()}addCustomersToNavTable(e,t,a){var r=new CustomerTableSQL,l=new CustomerProfileOutput,s=["fullName","telephones"],o={body:[]};r.select(e,t,e=>{e.forEach(e=>{let t=[];t[t.length]={id:e.id};for(var a=0;a<s.length;a++){let r=e[s[a]];"object"==typeof r&&(r=JSON.stringify(r).slice(4,-1).split('","').join("<br>").replace(/\"/g,"")),t[t.length]=[r,1,1]}o.body[o.body.length]=t}),e[0]&&(g.Controller.CustomerProfile.customerNavTableScrollCounter=-1),l.insertData("WP_Tbl",o),a&&a()})}fillCustomerWin(e,t){var a=new CustomerProfileOutput;(new CustomerTableSQL).load([e],r=>{var l=r[0];l=null!=l?l:{fullName:"",telephones:[""],adresses:[""],email:"",notes:"",preferences:"",socialMedia:[""],activity:"",isEmpty:!0};a.insertData("WP_ID",e),a.insertData("WP_Nm",l.fullName),a.insertData("WP_Tel",l.telephones),a.insertData("WP_Adr",l.adresses),a.insertData("WP_E-m",l.email),a.insertData("WP_Nt",l.notes),a.insertData("WP_Pr",l.preferences),a.insertData("WP_SM",l.socialMedia),a.insertData("WP_Act",l.activity),g.Controller.CustomerProfile.orderNavTableScrollCounter=0,a.insertData("WO_Tbl",{body:-1}),l.isEmpty||this.addOrdersToTable(e,void 0,t)})}addOrdersToTable(e,t,a,r){e=parseInt(e);let l=(new CustomerProfileInput).takeData("WO_SF");l=""!=l?l:void 0,l&&(g.Controller.CustomerProfile.orderNavTableScrollCounter=0);let s=new OrderTableSQL,o=new CycleTableSQL,i=new CustomerProfileOutput;-1!=g.Controller.CustomerProfile.orderNavTableScrollCounter&&o.select("1=1",[],l=>{s.select((null!=t?"id = ?":"customerID = ?")+(r?"":" ORDER BY id DESC LIMIT ?, ?"),r?[t]:[null!=t?t:e,g.Controller.CustomerProfile.orderNavTableScrollCounter*g.Controller.CustomerProfile.orderNavTableCountToSelect,g.Controller.CustomerProfile.orderNavTableCountToSelect],e=>{if(e.length>0){let a;var t={body:[]};a=["cycleID","kits","products","adress","summary","billed","pays","payDates","orderNotes","socialMedia"],e.forEach(e=>{let l=[];l[l.length]={id:e.id};for(var s=0;s<a.length;s++)l[l.length]=[r(e,a[s]),1,1];t.body[t.body.length]=l}),i.insertData("WO_Tbl",t),g.Controller.CustomerProfile.orderNavTableScrollCounter++}else g.Controller.CustomerProfile.orderNavTableScrollCounter=-1;function r(e,t){switch(t){case"cycleID":let a=l.find(a=>a.id==e[t]);return a?a.name:"Not Selected";case"kits":return Object.keys(e.kits).join(", ");case"products":return Object.keys(e.kits).map(t=>t+": ["+e.kits[t].products.map(e=>e.name+": "+e.count).join(", ")+"]").join("<br>");case"pays":case"payDates":return e[t].shift(),e[t].join(", ");default:return e[t]}}a&&a()})})}fillOrderCreatingWin(e,t,a){var r=new OrderTableSQL,l=new CustomerTableSQL,s=new CycleTableSQL,o=new KitTableSQL,i=new CustomerProfileOutput;r.load([t],n=>{var c=n[0];c||(c={id:-1,telephone:[""],socialMedia:[""],adress:[""],orderNotes:"",summary:0,billed:!1,isNotThis:!1,payDates:[""],pays:[""],cycleID:-1,customerID:e}),l.load([e],e=>{let l=e[0];l?(i.insertData("AW_Opn",!0),i.insertData("AW_Nm",l.fullName),i.insertData("AW_Pr",l.preferences),i.insertData("AW_Tel",[c.telephone[0],...l.telephones.filter(e=>e!=c.telephone[0])]),i.insertData("AW_SM",[c.socialMedia[0],...l.socialMedia.filter(e=>e!=c.socialMedia[0])]),i.insertData("AW_Adr",[c.adress[0],...l.adresses.filter(e=>e!=c.adress[0])]),i.insertData("AW_ID",c.id),i.insertData("AW_ON",c.orderNotes),i.insertData("AW_Sum",c.summary),i.insertData("AW_Bill","true"==c.billed),i.insertData("AW_n_ths","true"==c.isNotThis),i.insertData("AW_an_FN","true"==c.isNotThis?c.anotherFullName:""),i.insertData("AW_an_Tel","true"==c.isNotThis?c.anotherTelephone:""),i.insertData("AW_P",c.payDates.map((e,t)=>[c.pays[t],e])),i.insertData("AW_kits",{}),-1==c.cycleID?s.select("TRUE",[],e=>{i.insertData("AW_c_id",[[-1,"Select Cycle"],...e.map(e=>[e.id,e.name])])}):s.select("TRUE",[],e=>{var t=e.find(e=>e.id==c.cycleID),r=e.filter(e=>e.id!=c.cycleID);i.insertData("AW_c_id",[[t.id,t.name],...r.map(e=>[e.id,e.name])]),o.select("cycleID = ?",[c.cycleID],e=>{(new ProductTableSQL).select("cycleID = ?",[c.cycleID],t=>{e.forEach((a,r)=>{let l={};e[r].products.forEach((e,t)=>l[e.name]=t),e[r].products=t.map(t=>{if(void 0!==l[t.name]){let a=e[r].products[l[t.name]];t.price.selected=a.price.selected,t.count=a.count}else t.price.selected=t.price["p-kt"],t.count=0;return JSON.parse(JSON.stringify(t))});var s=c.kits[a.name];if(!s)return!1;e[r].count="number"==typeof s.count?s.count:0,e[r].price="number"==typeof s.price?s.price:e[r].price;var o={};s.products.forEach((e,t)=>o[e.name]=t);let i=0,n=0;a.products.forEach((e,t)=>{void 0!==o[e.name]?(e.count=s.products[o[e.name]].count,e.price.selected=s.products[o[e.name]].price.selected,e.count>0&&(i+=e.count*e.price[e.price.selected],n+=e.weight*e.count)):(e.count=0,e.price.selected="p-kt"),a.products[t]=Object.assign({},e)}),a.pcPrice=i,a.pcWeight=n,console.log(a,i,n)});var r={};e.forEach(e=>{r[e.name]=JSON.parse(JSON.stringify(e))}),i.insertData("AW_kits",r),i.insertData("AW_SumPC",e.filter(e=>e.count>0).map(e=>e.count*(e.price?e.price:e.pcPrice)).reduce((e,t)=>e+t,0)+" uah"),a&&a()})})})):(i.insertData("O_Tbl",{body:[[{id:t}]]}),r.del([t]))})})}displayKits(e){var t=new CustomerProfileOutput;new CycleTableSQL;(new KitTableSQL).select("cycleID = ?",[e],a=>{var r={};(new ProductTableSQL).select("cycleID = ?",[e],e=>{for(var l in a){let t=a[l],s={};t.products.forEach((e,t)=>s[e.name]=t),t.products=e.map(e=>{if(void 0!==s[e.name]){let a=t.products[s[e.name]];e.price.selected=a.selected,e.count=a.count}else e.price.selected=e.price["p-kt"],e.count=0;return e}),a[l].count||(a[l].count=0),r[a[l].name]=JSON.parse(JSON.stringify(t))}t.insertData("AW_kits",r)})})}deleteCustomer(e){var t=new CustomerTableSQL,a=new CustomerProfileOutput;(new CustomerProfileInput).takeData("WP_ID")==e&&this.fillCustomerWin(-1),a.insertData("WP_Tbl_CD",e),t.del([e]),console.log(e)}deleteOrder(e){var t=new OrderTableSQL,a=new CustomerProfileOutput;t.del([e]),a.insertData("WP_Tbl_OD",e)}getCustomerFromPage(){var e=new CustomerProfileInput;return new CustomerModel({id:e.takeData("WP_ID"),fullName:e.takeData("WP_Nm"),telephones:["",...e.takeData("WP_Tel").filter(e=>e)],adresses:["",...e.takeData("WP_Adr").filter(e=>e)],email:e.takeData("WP_E-m"),notes:e.takeData("WP_Nt"),preferences:e.takeData("WP_Pr"),socialMedia:e.takeData("WP_SM"),activity:e.takeData("WP_Act")})}getOrderFromPage(e,t){let a=new CustomerProfileInput,r=new OrderModel({id:a.takeData("AW_ID"),cycleID:a.takeData("AW_c_id"),telephone:a.takeData("AW_Tel"),socialMedia:a.takeData("AW_SM"),adress:a.takeData("AW_Adr"),orderNotes:a.takeData("AW_ON"),summary:a.takeData("AW_Sum"),billed:a.takeData("AW_Bill"),isNotThis:a.takeData("AW_n_ths"),customerID:a.takeData("WP_ID"),anotherFullName:a.takeData("AW_an_FN"),anotherTelephone:a.takeData("AW_an_Tel"),kits:a.takeData("AW_kits")});if(t)return r.kits;let l=this.getCustomerFromPage();l.preferences=a.takeData("AW_Pr");let[s,o,i]=[l.telephones.find(e=>e==r.telephone),l.adresses.find(e=>e==r.adress),l.socialMedia.find(e=>e==r.socialMedia)];s||l.telephones.push(r.telephone),o||l.adresses.push(r.adress),i||l.socialMedia.push(r.socialMedia);const n=a.takeData("AW_P");let c=n.map(e=>e[0]),u=n.map(e=>e[1]);return r.pays=c,r.payDates=u,[r,l]}saveCustomer(e,t){let a=new CustomerTableSQL;-1==e.id&&delete e.id,a.save([e],e=>{t(e[0])})}saveOrder(e,t){let a=new OrderTableSQL;-1==e.id&&delete e.id,a.save([e],e=>{t(e[0])})}addToArray(e,t){if(!e)return!1;let a=new CustomerProfileInput,r=new CustomerProfileOutput,l=a.takeData(e);l[l.length]=JSON.parse(JSON.stringify(l[0])),l[0]=t,r.insertData(e,l)}selectTable(e){Array.from((new CustomerProfileInput).takeData("Tbl_rows")).forEach(t=>{var a=!1;Array.from(t.querySelectorAll("td")).forEach(t=>{t.innerHTML.search(e)>-1&&(a=!0)}),t.style.display=a?"table-row":"none"})}updateOrderForm(e){let t=new CustomerProfileOutput;for(var a in e)e[a].name=a;let r=Object.values(e).filter(e=>e.count>0).map(e=>[e.count*(e.price?e.price:e.pcPrice),e.name]);t.insertData("AW_SumPC",r.map(e=>e[0]).reduce((e,t)=>e+t,0)+" uah"),r.forEach(a=>{t.insertData("AW_KtPC",[e[a[1]].pcPrice,e[a[1]].pcWeight,a[1]])})}}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkRBTy9DdXN0b21lclByb2ZpbGVEQU8uanMiXSwibmFtZXMiOlsiQ3VzdG9tZXJQcm9maWxlREFPIiwiREFPIiwiW29iamVjdCBPYmplY3RdIiwic3VwZXIiLCJ3aGVyZSIsImRhdGEiLCJjYiIsImRiIiwiQ3VzdG9tZXJUYWJsZVNRTCIsIm91dCIsIkN1c3RvbWVyUHJvZmlsZU91dHB1dCIsImNvbHVtbnMiLCJ0YWJsZU9iamVjdCIsImJvZHkiLCJzZWxlY3QiLCJjdXN0b21lcnMiLCJmb3JFYWNoIiwiY3VzdG9tZXIiLCJyb3ciLCJsZW5ndGgiLCJpZCIsImkiLCJ2YWwiLCJKU09OIiwic3RyaW5naWZ5Iiwic2xpY2UiLCJzcGxpdCIsImpvaW4iLCJyZXBsYWNlIiwiZyIsIkNvbnRyb2xsZXIiLCJDdXN0b21lclByb2ZpbGUiLCJjdXN0b21lck5hdlRhYmxlU2Nyb2xsQ291bnRlciIsImluc2VydERhdGEiLCJjdXN0b21lcklEIiwibG9hZCIsInVuZGVmaW5lZCIsImZ1bGxOYW1lIiwidGVsZXBob25lcyIsImFkcmVzc2VzIiwiZW1haWwiLCJub3RlcyIsInByZWZlcmVuY2VzIiwic29jaWFsTWVkaWEiLCJhY3Rpdml0eSIsImlzRW1wdHkiLCJvcmRlck5hdlRhYmxlU2Nyb2xsQ291bnRlciIsInRoaXMiLCJhZGRPcmRlcnNUb1RhYmxlIiwib3JkZXJJRCIsImlzTmV3IiwicGFyc2VJbnQiLCJzIiwiQ3VzdG9tZXJQcm9maWxlSW5wdXQiLCJ0YWtlRGF0YSIsIk9yZGVyVGFibGVTUUwiLCJkYkN5Y2xlIiwiQ3ljbGVUYWJsZVNRTCIsImN5Y2xlcyIsIm9yZGVyTmF2VGFibGVDb3VudFRvU2VsZWN0Iiwib3JkZXJzIiwib3JkZXIiLCJjb252ZXJ0RmllbGQiLCJvIiwiYyIsInIiLCJmaW5kIiwiY3ljbGUiLCJuYW1lIiwiT2JqZWN0Iiwia2V5cyIsImtpdHMiLCJtYXAiLCJraXROYW1lIiwicHJvZHVjdHMiLCJwciIsImNvdW50Iiwic2hpZnQiLCJkYk9yZGVyIiwiZGJDdXN0b21lciIsImRiS2l0IiwiS2l0VGFibGVTUUwiLCJ0ZWxlcGhvbmUiLCJhZHJlc3MiLCJvcmRlck5vdGVzIiwic3VtbWFyeSIsImJpbGxlZCIsImlzTm90VGhpcyIsInBheURhdGVzIiwicGF5cyIsImN5Y2xlSUQiLCJmaWx0ZXIiLCJ0ZWwiLCJtZWRpYSIsImQiLCJzZWxlY3RlZEN5Y2xlIiwicmVzdEN5Y2xlcyIsImtpdHNGcm9tREIiLCJQcm9kdWN0VGFibGVTUUwiLCJraXQiLCJpZE1hcCIsImtQciIsInByaWNlIiwic2VsZWN0ZWQiLCJwYXJzZSIsIm9yZGVyS2l0IiwibmFtZXMiLCJwY1ByaWNlIiwicGNXZWlnaHQiLCJ3ZWlnaHQiLCJhc3NpZ24iLCJjb25zb2xlIiwibG9nIiwia2l0c0RhdGEiLCJyZWR1Y2UiLCJhIiwiYiIsImRlbCIsImsiLCJmaWxsQ3VzdG9tZXJXaW4iLCJpbnAiLCJDdXN0b21lck1vZGVsIiwiZWwiLCJyZXR1cm5Pbmx5S2l0cyIsIk9yZGVyTW9kZWwiLCJhbm90aGVyRnVsbE5hbWUiLCJhbm90aGVyVGVsZXBob25lIiwiZ2V0Q3VzdG9tZXJGcm9tUGFnZSIsInRlbHMiLCJhZHJzIiwic29jcyIsInQiLCJwdXNoIiwicGF5RGF0YSIsImRhdGVzIiwic2F2ZSIsImlucE5hbWUiLCJlbXAiLCJ2YWxzIiwic2VhcmNoIiwiQXJyYXkiLCJmcm9tIiwidHIiLCJoYXNTZWFyY2hlZCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJ0ZCIsImlubmVySFRNTCIsInN0eWxlIiwiZGlzcGxheSIsInZhbHVlcyIsImUiXSwibWFwcGluZ3MiOiJBQTRDQSxNQUFNQSwyQkFBMkJDLElBQy9CQyxjQUNFQyxRQUdGRCx1QkFBdUJFLEVBQU9DLEVBQU1DLEdBQ2xDLElBQUlDLEVBQUssSUFBSUMsaUJBQ1RDLEVBQU0sSUFBSUMsc0JBQ1ZDLEVBQVUsQ0FBQyxXQUFZLGNBQ3ZCQyxFQUFjLENBQUNDLEtBQUssSUFFeEJOLEVBQUdPLE9BQU9WLEVBQU9DLEVBQU1VLElBRXJCQSxF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QUcsR0FBTSxRQUM5RS9HLEVBQUtXLFFBQVE4RSxJQUNYckYsRUFBSXdCLFdBQVcsVUFBVyxDQUFDc0MsRUFBS3VCLEVBQUUsSUFBSWEsUUFBU3BDLEVBQUt1QixFQUFFLElBQUljLFNBQVVkLEVBQUUiLCJmaWxlIjoiREFPL0N1c3RvbWVyUHJvZmlsZURBTy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG5AY2xhc3MgQ3VzdG9tZXJQcm9maWxlREFPXHJcbkBkZXNjIGdpdmUgbWV0aG9kIHRvIGVhc3kgbW9kZXJhdGUgcGFnZSBhbmQgZGF0YSBvbiB0aGlzIHBhZ2VcclxuXHJcbkBtZXRob2RzXHJcbiAgQG1ldGhvZCBhZGRDdXN0b21lcnNUb05hdlRhYmxlXHJcbiAgICBAcGFyYW0ge1N0cmluZ30gd2hlcmVcclxuICAgIEBwYXJhbSB7T2JqZWN0fSBkYXRhXHJcbiAgICBAZG8gYWRkIG5ldyBjdXN0b21lcnMgYXMgPHRyPiB0byBuYXYgdGFibGUgb2YgY3VzdG9tZXJzXHJcbiAgQG1ldGhvZCBmaWxsQ3VzdG9tZXJXaW5cclxuICAgIEBwYXJhbSB7SW50YWdlcn0gY3VzdG9tZXJJRFxyXG4gICAgQGRvIGdldCBjdXN0b21lciBmcm9tIGRiIGFuZCBmaWxsIGFsbCBmaWVsZHMgaW4gY3VzdG9tZXIgd2luZG93cyBhbmQgZ2VuZXJhdGUgdGFibGUgb2YgaGlzIG9yZGVyc1xyXG4gIEBtZXRob2QgZmlsbE9yZGVyQ3JlYXRpbmdXaW5cclxuICAgIEBwYXJhbSB7SW50YWdlcn0gY3VzdG9tZXJJRFxyXG4gICAgQHBhcmFtIHtJbnRhZ2VyfSBvcmRlcklEXHJcbiAgICBAZG8gZ2V0IGN1c3RvbWVyIGFuZCBvcmRlciBmcm9tIGRiIGFuZCB0aGVuIGZpbGwgYWxsIG5lZWRlZCBmaWVsZHMgaW4gb3JkZXIgY3JlYXRpbmcgd2luZG93XHJcbiAgQG1ldGhvZCBkaXNwbGF5S2l0c1xyXG4gICAgQHBhcmFtIHtJbnRhZ2VyfSBjeWNsZUlEXHJcbiAgICBAZG8gZGlzcGxheSBhbGwga2l0cyBvZiBzZWxlY3RlZCBjeWNsZSBpbiBvcmRlciBjcmVhdGluZyB3aW5kb3dcclxuICBAbWV0aG9kIGRlbGV0ZUN1c3RvbWVyXHJcbiAgICBAcGFyYW0ge0ludGFnZXJ9IGN1c3RvbWVySURcclxuICAgIEBkbyBkZWxldGUgY3VzdG9tZXIgZnJvbSBkYiBhbmQgZnJvbSBuYXYgdGFibGUgb2YgY3VzdG9tZXJzXHJcbiAgQG1ldGhvZCBkZWxldGVPcmRlclxyXG4gICAgQHBhcmFtIHtJbnRhZ2VyfSBvcmRlcklEXHJcbiAgICBAZG8gZGVsZXRlIG9yZGVyIGZyb20gZGIgYW5kIGZyb20gbmF2IHRhYmxlIG9mIGN1c3RvbWVyJ3Mgb3JkZXJzXHJcbiAgQG1ldGhvZCBnZXRDdXN0b21lckZyb21QYWdlXHJcbiAgICBAcmV0dXJuIHtDdXN0b21lcn0gY3VzdG9tZXJcclxuICAgIEBkbyByZWFkIGFsbCBuZWVkIGZpZWxkcyBhbmQgdGFrZSBpdHMgdmFsdWVzIHRvIHRoZSBjdXN0b21lciBvYmplY3QuXHJcbiAgQG1ldGhvZCBnZXRPcmRlckZyb21QYWdlXHJcbiAgICBAcmV0dXJuIHtBcnJheTxPcmRlciwgQ3VzdG9tZXI+fSBbb3JkZXIsIGN1c3RvbWVyXVxyXG4gICAgQGRvIHJlYWQgYWxsIG5lZWQgZmllbGRzIGFuZCB0YWtlIGl0cyB2YWx1ZXMgdG8gdGhlIG9yZGVyIG9iamVjdCBhbmQgcmV0dXJucyB1cGRhdGVkIGN1c3RvbWVyIG9iamVjdGVkLlxyXG4gIEBtZXRob2Qgc2F2ZUN1c3RvbWVyXHJcbiAgICBAcGFyYW0ge0N1c3RvbWVyfSBjdXN0b21lclxyXG4gICAgQHJldHVybiB7Q3VzdG9tZXJ9IGN1c3RvbWVyXHJcbiAgICBAZG8gdGFrZSBjdXN0b21lciBvYmplY3QgYW5kIHNhdmUgaXQgdG8gZGIuIElmIGl0IGlzIG5ldyBjdXN0b21lciBzZXQgaWQgdG8gdGhlIG9iamVjdCBhbmQgcmV0dXJuIGl0LiBPYmplY3QgaWYgbmV3IGFuZCB1bmRlZmluZWQgaWYgdXBkYXRlZFxyXG4gIEBtZXRob2Qgc2F2ZU9yZGVyXHJcbiAgICBAcGFyYW0ge0N1c3RvbWVyfSBvcmRlclxyXG4gICAgQHJldHVybiB7Q3VzdG9tZXJ9IG9yZGVyXHJcbiAgICBAZG8gdGFrZSBvcmRlciBvYmplY3QgYW5kIHNhdmUgaXQgdG8gZGIuIElmIGl0IGlzIG5ldyBvcmRlciBzZXQgaWQgdG8gdGhlIG9iamVjdCBhbmQgcmV0dXJuIGl0LiBPYmplY3QgaWYgbmV3IGFuZCB1bmRlZmluZWQgaWYgdXBkYXRlZFxyXG4gIEBtZXRob2QgYWRkVG9BcnJheVxyXG4gICAgQHBhcmFtIHtTdHJpbmd9IGlucE5hbWVcclxuICAgIEBwYXJhbSB7fSBlbXAgPT4gZW1wdHkgZGF0YSBmb3IgZmllbGRzIHRvIGJlIGNsZWFuZWRcclxuICAgIEBkbyB0YWtlIGRhdGEgZnJvbSBuZWVkZWQgZmllbGQgb3IgZmllbGRzIGFuZCBwYXN0ZSBuZXcgZWxlbWVudCB0byBodG1sLWFycmF5XHJcbiovXHJcbmNsYXNzIEN1c3RvbWVyUHJvZmlsZURBTyBleHRlbmRzIERBT3tcclxuICBjb25zdHJ1Y3Rvcigpe1xyXG4gICAgc3VwZXIoKTtcclxuICB9XHJcblxyXG4gIGFkZEN1c3RvbWVyc1RvTmF2VGFibGUod2hlcmUsIGRhdGEsIGNiKXtcclxuICAgIHZhciBkYiA9IG5ldyBDdXN0b21lclRhYmxlU1FMKCk7XHJcbiAgICB2YXIgb3V0ID0gbmV3IEN1c3RvbWVyUHJvZmlsZU91dHB1dCgpO1xyXG4gICAgdmFyIGNvbHVtbnMgPSBbXCJmdWxsTmFtZVwiLCBcInRlbGVwaG9uZXNcIl07XHJcbiAgICB2YXIgdGFibGVPYmplY3QgPSB7Ym9keTpbXX07XHJcblxyXG4gICAgZGIuc2VsZWN0KHdoZXJlLCBkYXRhLCBjdXN0b21lcnMgPT4ge1xyXG5cclxuICAgICAgY3VzdG9tZXJzLmZvckVhY2goY3VzdG9tZXIgPT4ge1xyXG4gICAgICAgIGxldCByb3cgPSBbXTtcclxuICAgICAgICByb3dbcm93Lmxlbmd0aF0gPSB7aWQ6IGN1c3RvbWVyLmlkfTtcclxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgY29sdW1ucy5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICBsZXQgdmFsID0gY3VzdG9tZXJbY29sdW1uc1tpXV07XHJcblxyXG4gICAgICAgICAgaWYodHlwZW9mIHZhbCA9PSBcIm9iamVjdFwiKSB2YWwgPSBKU09OLnN0cmluZ2lmeSh2YWwpLnNsaWNlKDQsIC0xKS5zcGxpdChcIlxcXCIsXFxcIlwiKS5qb2luKFwiPGJyPlwiKS5yZXBsYWNlKC9cXFwiL2csIFwiXCIpO1xyXG5cclxuICAgICAgICAgIHJvd1tyb3cubGVuZ3RoXSA9IFt2YWwsIDEsIDFdO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0YWJsZU9iamVjdC5ib2R5W3RhYmxlT2JqZWN0LmJvZHkubGVuZ3RoXSA9IHJvdztcclxuICAgICAgfSk7XHJcbiAgICAgIGlmKGN1c3RvbWVyc1swXSkgZy5Db250cm9sbGVyLkN1c3RvbWVyUHJvZmlsZS5jdXN0b21lck5hdlRhYmxlU2Nyb2xsQ291bnRlciA9IC0xO1xyXG4gICAgICBvdXQuaW5zZXJ0RGF0YShcIldQX1RibFwiLCB0YWJsZU9iamVjdCk7XHJcbiAgICAgIGlmKGNiKSBjYigpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmaWxsQ3VzdG9tZXJXaW4oY3VzdG9tZXJJRCwgY2Ipe1xyXG4gICAgdmFyIG91dCA9IG5ldyBDdXN0b21lclByb2ZpbGVPdXRwdXQoKTtcclxuICAgIHZhciBkYiA9IG5ldyBDdXN0b21lclRhYmxlU1FMKCk7XHJcbiAgICBkYi5sb2FkKFtjdXN0b21lcklEXSwgY3VzdG9tZXJzID0+IHtcclxuICAgICAgdmFyIGN1c3RvbWVyID0gY3VzdG9tZXJzWzBdO1xyXG4gICAgICBjdXN0b21lciA9IGN1c3RvbWVyIT11bmRlZmluZWQ/Y3VzdG9tZXI6e2Z1bGxOYW1lOlwiXCIsIHRlbGVwaG9uZXM6IFtcIlwiXSwgYWRyZXNzZXM6IFtcIlwiXSwgZW1haWw6IFwiXCIsIG5vdGVzOiBcIlwiLCBwcmVmZXJlbmNlczogXCJcIiwgc29jaWFsTWVkaWE6IFtcIlwiXSwgYWN0aXZpdHk6IFwiXCIsIGlzRW1wdHk6IHRydWV9O1xyXG4gICAgICB2YXIgY29sdW1ucyA9IFtcImZ1bGxOYW1lXCIsIFwidGVsZXBob25lXCJdO1xyXG5cclxuICAgICAgb3V0Lmluc2VydERhdGEoXCJXUF9JRFwiLCBjdXN0b21lcklEKTtcclxuICAgICAgb3V0Lmluc2VydERhdGEoXCJXUF9ObVwiLCBjdXN0b21lcltcImZ1bGxOYW1lXCJdKTtcclxuICAgICAgb3V0Lmluc2VydERhdGEoXCJXUF9UZWxcIiwgY3VzdG9tZXJbXCJ0ZWxlcGhvbmVzXCJdKTtcclxuICAgICAgb3V0Lmluc2VydERhdGEoXCJXUF9BZHJcIiwgY3VzdG9tZXJbXCJhZHJlc3Nlc1wiXSk7XHJcbiAgICAgIG91dC5pbnNlcnREYXRhKFwiV1BfRS1tXCIsIGN1c3RvbWVyW1wiZW1haWxcIl0pO1xyXG4gICAgICBvdXQuaW5zZXJ0RGF0YShcIldQX050XCIsIGN1c3RvbWVyW1wibm90ZXNcIl0pO1xyXG4gICAgICBvdXQuaW5zZXJ0RGF0YShcIldQX1ByXCIsIGN1c3RvbWVyW1wicHJlZmVyZW5jZXNcIl0pO1xyXG4gICAgICBvdXQuaW5zZXJ0RGF0YShcIldQX1NNXCIsIGN1c3RvbWVyW1wic29jaWFsTWVkaWFcIl0pO1xyXG4gICAgICBvdXQuaW5zZXJ0RGF0YShcIldQX0FjdFwiLCBjdXN0b21lcltcImFjdGl2aXR5XCJdKTtcclxuXHJcbiAgICAgIGcuQ29udHJvbGxlci5DdXN0b21lclByb2ZpbGUub3JkZXJOYXZUYWJsZVNjcm9sbENvdW50ZXIgPSAwO1xyXG5cclxuICAgICAgb3V0Lmluc2VydERhdGEoXCJXT19UYmxcIiwge2JvZHk6IC0xfSk7XHJcblxyXG4gICAgICBpZighY3VzdG9tZXIuaXNFbXB0eSkgdGhpcy5hZGRPcmRlcnNUb1RhYmxlKGN1c3RvbWVySUQsIHVuZGVmaW5lZCwgY2IpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRPcmRlcnNUb1RhYmxlKGN1c3RvbWVySUQsIG9yZGVySUQsIGNiLCBpc05ldyl7XHJcbiAgICBjdXN0b21lcklEID0gcGFyc2VJbnQoY3VzdG9tZXJJRCk7XHJcbiAgICBsZXQgcyA9IChuZXcgQ3VzdG9tZXJQcm9maWxlSW5wdXQoKSkudGFrZURhdGEoXCJXT19TRlwiKTtcclxuICAgIHMgPSAocyAhPSBcIlwiKT9zOnVuZGVmaW5lZDtcclxuICAgIGlmKHMpIGcuQ29udHJvbGxlci5DdXN0b21lclByb2ZpbGUub3JkZXJOYXZUYWJsZVNjcm9sbENvdW50ZXIgPSAwO1xyXG4gICAgbGV0IGRiID0gbmV3IE9yZGVyVGFibGVTUUwoKTtcclxuICAgIGxldCBkYkN5Y2xlID0gbmV3IEN5Y2xlVGFibGVTUUwoKTtcclxuICAgIGxldCBvdXQgPSBuZXcgQ3VzdG9tZXJQcm9maWxlT3V0cHV0KCk7XHJcblxyXG4gICAgaWYoZy5Db250cm9sbGVyLkN1c3RvbWVyUHJvZmlsZS5vcmRlck5hdlRhYmxlU2Nyb2xsQ291bnRlciAhPSAtMSkgZGJDeWNsZS5zZWxlY3QoXCIxPTFcIiwgW10sIGN5Y2xlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBkYi5zZWxlY3QoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChvcmRlcklEIT11bmRlZmluZWQ/J2lkID0gPyc6XCJjdXN0b21lcklEID0gP1wiKSArIChpc05ldz9cIlwiOlwiIE9SREVSIEJZIGlkIERFU0MgTElNSVQgPywgP1wiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNOZXc/W29yZGVySURdOltcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlcklEIT11bmRlZmluZWQ/b3JkZXJJRDpjdXN0b21lcklELFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGcuQ29udHJvbGxlci5DdXN0b21lclByb2ZpbGUub3JkZXJOYXZUYWJsZVNjcm9sbENvdW50ZXIqZy5Db250cm9sbGVyLkN1c3RvbWVyUHJvZmlsZS5vcmRlck5hdlRhYmxlQ291bnRUb1NlbGVjdCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBnLkNvbnRyb2xsZXIuQ3VzdG9tZXJQcm9maWxlLm9yZGVyTmF2VGFibGVDb3VudFRvU2VsZWN0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVycyA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYob3JkZXJzLmxlbmd0aCA+IDApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbHVtbnM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGVPYmplY3QgPSB7Ym9keTpbXX07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5zID0gW1wiY3ljbGVJRFwiLCBcImtpdHNcIiwgXCJwcm9kdWN0c1wiLCBcImFkcmVzc1wiLCBcInN1bW1hcnlcIiwgXCJiaWxsZWRcIiwgXCJwYXlzXCIsIFwicGF5RGF0ZXNcIiwgXCJvcmRlck5vdGVzXCIsIFwic29jaWFsTWVkaWFcIl07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlcnMuZm9yRWFjaChvcmRlciA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJvdyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd1tyb3cubGVuZ3RoXSA9IHtpZDogb3JkZXIuaWR9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCBjb2x1bW5zLmxlbmd0aDsgaSsrKSByb3dbcm93Lmxlbmd0aF0gPSBbY29udmVydEZpZWxkKG9yZGVyLCBjb2x1bW5zW2ldKSwgMSwgMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVPYmplY3QuYm9keVt0YWJsZU9iamVjdC5ib2R5Lmxlbmd0aF0gPSByb3c7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0Lmluc2VydERhdGEoXCJXT19UYmxcIiwgdGFibGVPYmplY3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZy5Db250cm9sbGVyLkN1c3RvbWVyUHJvZmlsZS5vcmRlck5hdlRhYmxlU2Nyb2xsQ291bnRlcisrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlIGcuQ29udHJvbGxlci5DdXN0b21lclByb2ZpbGUub3JkZXJOYXZUYWJsZVNjcm9sbENvdW50ZXIgPSAtMTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY2IpIGNiKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNvbnZlcnRGaWVsZChvLCBjKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChjKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImN5Y2xlSURcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgciA9IGN5Y2xlcy5maW5kKGN5Y2xlID0+IGN5Y2xlLmlkID09IG9bY10pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHI/ci5uYW1lOlwiTm90IFNlbGVjdGVkXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJraXRzXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKG8ua2l0cykuam9pbihcIiwgXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwicHJvZHVjdHNcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoby5raXRzKS5tYXAoa2l0TmFtZSA9PiBraXROYW1lICsgXCI6IFtcIiArIG8ua2l0c1traXROYW1lXS5wcm9kdWN0cy5tYXAocHIgPT4gcHIubmFtZSArIFwiOiBcIiArIHByLmNvdW50KS5qb2luKFwiLCBcIikgKyBcIl1cIikuam9pbihcIjxicj5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJwYXlzXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb1tjXS5zaGlmdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvW2NdLmpvaW4oXCIsIFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcInBheURhdGVzXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb1tjXS5zaGlmdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvW2NdLmpvaW4oXCIsIFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb1tjXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICB9XHJcblxyXG4gIGZpbGxPcmRlckNyZWF0aW5nV2luKGN1c3RvbWVySUQsb3JkZXJJRCwgY2Ipe1xyXG4gICAgdmFyIGRiT3JkZXIgPSBuZXcgT3JkZXJUYWJsZVNRTCgpO1xyXG4gICAgdmFyIGRiQ3VzdG9tZXIgPSBuZXcgQ3VzdG9tZXJUYWJsZVNRTCgpO1xyXG4gICAgdmFyIGRiQ3ljbGUgPSBuZXcgQ3ljbGVUYWJsZVNRTCgpO1xyXG4gICAgdmFyIGRiS2l0ID0gbmV3IEtpdFRhYmxlU1FMKCk7XHJcbiAgICB2YXIgb3V0ID0gbmV3IEN1c3RvbWVyUHJvZmlsZU91dHB1dCgpO1xyXG5cclxuICAgIGRiT3JkZXIubG9hZChbb3JkZXJJRF0sIG9yZGVycyA9PiB7XHJcbiAgICAgIHZhciBvcmRlciA9IG9yZGVyc1swXTtcclxuICAgICAgaWYoIW9yZGVyKSBvcmRlciA9IHtpZDogLTEsIHRlbGVwaG9uZTogW1wiXCJdLCBzb2NpYWxNZWRpYTogW1wiXCJdLCBhZHJlc3M6IFtcIlwiXSwgb3JkZXJOb3RlczogXCJcIiwgc3VtbWFyeTogMCwgYmlsbGVkOiBmYWxzZSwgaXNOb3RUaGlzOiBmYWxzZSwgcGF5RGF0ZXM6IFtcIlwiXSwgcGF5czogW1wiXCJdLCBjeWNsZUlEOiAtMSwgY3VzdG9tZXJJRDogY3VzdG9tZXJJRH07XHJcblxyXG4gICAgICBkYkN1c3RvbWVyLmxvYWQoW2N1c3RvbWVySURdLCBjdXN0b21lcnMgPT4ge1xyXG4gICAgICAgIGxldCBjdXN0b21lciA9IGN1c3RvbWVyc1swXTtcclxuXHJcbiAgICAgICAgaWYoIWN1c3RvbWVyKXtcclxuICAgICAgICAgIG91dC5pbnNlcnREYXRhKFwiT19UYmxcIiwge2JvZHk6W1t7aWQ6IG9yZGVySUR9XV19KTtcclxuICAgICAgICAgIGRiT3JkZXIuZGVsKFtvcmRlcklEXSk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICBvdXQuaW5zZXJ0RGF0YShcIkFXX09wblwiLCB0cnVlKTtcclxuXHJcbiAgICAgICAgICAvL2ZpbGwgZmllbGRzIGZyb20gY3VzdG9tZXIgb2JqZWN0XHJcbiAgICAgICAgICBvdXQuaW5zZXJ0RGF0YShcIkFXX05tXCIsIGN1c3RvbWVyW1wiZnVsbE5hbWVcIl0pO1xyXG4gICAgICAgICAgb3V0Lmluc2VydERhdGEoXCJBV19QclwiLCBjdXN0b21lcltcInByZWZlcmVuY2VzXCJdKTtcclxuICAgICAgICAgIC8vZmlsbCBmaWVsZHMgZnJvbSBjdXN0b21lciBhbmQgb3JkZXIgb2JqZWN0c1xyXG4gICAgICAgICAgb3V0Lmluc2VydERhdGEoXCJBV19UZWxcIiwgW29yZGVyW1widGVsZXBob25lXCJdWzBdLCAuLi5jdXN0b21lcltcInRlbGVwaG9uZXNcIl0uZmlsdGVyKHRlbCA9PiB0ZWwgIT0gb3JkZXJbXCJ0ZWxlcGhvbmVcIl1bMF0pXSk7XHJcbiAgICAgICAgICBvdXQuaW5zZXJ0RGF0YShcIkFXX1NNXCIsIFtvcmRlcltcInNvY2lhbE1lZGlhXCJdWzBdLCAuLi5jdXN0b21lcltcInNvY2lhbE1lZGlhXCJdLmZpbHRlcihtZWRpYSA9PiBtZWRpYSAhPSBvcmRlcltcInNvY2lhbE1lZGlhXCJdWzBdKV0pO1xyXG4gICAgICAgICAgb3V0Lmluc2VydERhdGEoXCJBV19BZHJcIiwgW29yZGVyW1wiYWRyZXNzXCJdWzBdLCAuLi5jdXN0b21lcltcImFkcmVzc2VzXCJdLmZpbHRlcihhZHJlc3MgPT4gYWRyZXNzICE9IG9yZGVyW1wiYWRyZXNzXCJdWzBdKV0pO1xyXG4gICAgICAgICAgLy9maWxsIGZpZWxkcyBmcm9tIG9yZGVyIG9iamVjdFxyXG4gICAgICAgICAgb3V0Lmluc2VydERhdGEoXCJBV19JRFwiLCBvcmRlcltcImlkXCJdKTtcclxuICAgICAgICAgIG91dC5pbnNlcnREYXRhKFwiQVdfT05cIiwgb3JkZXJbXCJvcmRlck5vdGVzXCJdKTtcclxuICAgICAgICAgIG91dC5pbnNlcnREYXRhKFwiQVdfU3VtXCIsIG9yZGVyW1wic3VtbWFyeVwiXSk7XHJcbiAgICAgICAgICBvdXQuaW5zZXJ0RGF0YShcIkFXX0JpbGxcIiwgb3JkZXJbXCJiaWxsZWRcIl0gPT0gXCJ0cnVlXCIpO1xyXG4gICAgICAgICAgb3V0Lmluc2VydERhdGEoXCJBV19uX3Roc1wiLCBvcmRlcltcImlzTm90VGhpc1wiXSA9PSBcInRydWVcIik7XHJcbiAgICAgICAgICBvdXQuaW5zZXJ0RGF0YShcIkFXX2FuX0ZOXCIsIG9yZGVyW1wiaXNOb3RUaGlzXCJdID09IFwidHJ1ZVwiP29yZGVyW1wiYW5vdGhlckZ1bGxOYW1lXCJdOlwiXCIpO1xyXG4gICAgICAgICAgb3V0Lmluc2VydERhdGEoXCJBV19hbl9UZWxcIiwgb3JkZXJbXCJpc05vdFRoaXNcIl0gPT0gXCJ0cnVlXCI/b3JkZXJbXCJhbm90aGVyVGVsZXBob25lXCJdOlwiXCIpO1xyXG4gICAgICAgICAgb3V0Lmluc2VydERhdGEoXCJBV19QXCIsIG9yZGVyW1wicGF5RGF0ZXNcIl0ubWFwKChkLCBpKSA9PiBbb3JkZXJbXCJwYXlzXCJdW2ldLCBkXSkpO1xyXG4gICAgICAgICAgLy9jbGVhciBraXRzXHJcbiAgICAgICAgICBvdXQuaW5zZXJ0RGF0YShcIkFXX2tpdHNcIiwge30pO1xyXG5cclxuICAgICAgICAgIGlmKG9yZGVyW1wiY3ljbGVJRFwiXSA9PSAtMSl7XHJcbiAgICAgICAgICAgIGRiQ3ljbGUuc2VsZWN0KFwiVFJVRVwiLCBbXSwgY3ljbGVzID0+IHtcclxuICAgICAgICAgICAgICBvdXQuaW5zZXJ0RGF0YShcIkFXX2NfaWRcIiwgW1stMSwgXCJTZWxlY3QgQ3ljbGVcIl0sIC4uLmN5Y2xlcy5tYXAoY3ljbGUgPT4gW2N5Y2xlW1wiaWRcIl0sIGN5Y2xlW1wibmFtZVwiXV0pIF0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH1lbHNlIGRiQ3ljbGUuc2VsZWN0KFwiVFJVRVwiLCBbXSwgY3ljbGVzID0+IHtcclxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkQ3ljbGUgPSBjeWNsZXMuZmluZChjeWNsZSA9PiBjeWNsZS5pZCA9PSBvcmRlci5jeWNsZUlEKTtcclxuICAgICAgICAgICAgdmFyIHJlc3RDeWNsZXMgPSBjeWNsZXMuZmlsdGVyKGN5Y2xlID0+IGN5Y2xlLmlkICE9IG9yZGVyLmN5Y2xlSUQpO1xyXG4gICAgICAgICAgICBvdXQuaW5zZXJ0RGF0YShcIkFXX2NfaWRcIiwgWyBbc2VsZWN0ZWRDeWNsZS5pZCwgc2VsZWN0ZWRDeWNsZS5uYW1lXSwgLi4ucmVzdEN5Y2xlcy5tYXAoY3ljbGUgPT4gW2N5Y2xlLmlkLCBjeWNsZS5uYW1lXSkgXSk7XHJcblxyXG4gICAgICAgICAgICBkYktpdC5zZWxlY3QoXCJjeWNsZUlEID0gP1wiLCBbb3JkZXIuY3ljbGVJRF0sIGtpdHNGcm9tREIgPT4ge1xyXG4gICAgICAgICAgICAgIChuZXcgUHJvZHVjdFRhYmxlU1FMKCkpLnNlbGVjdChcImN5Y2xlSUQgPSA/XCIsIFtvcmRlci5jeWNsZUlEXSwgcHJvZHVjdHMgPT4ge1xyXG4gICAgICAgICAgICAgICAga2l0c0Zyb21EQi5mb3JFYWNoKChraXQsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgbGV0IGlkTWFwID0ge307XHJcbiAgICAgICAgICAgICAgICAgIGtpdHNGcm9tREJbaV0ucHJvZHVjdHMuZm9yRWFjaCgocHIsIGkpID0+IGlkTWFwW3ByLm5hbWVdID0gaSk7XHJcbiAgICAgICAgICAgICAgICAgIGtpdHNGcm9tREJbaV0ucHJvZHVjdHMgPSBwcm9kdWN0cy5tYXAocHIgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBpZE1hcFtwci5uYW1lXSAhPSBcInVuZGVmaW5lZFwiKXtcclxuICAgICAgICAgICAgICAgICAgICAgIGxldCBrUHIgPSBraXRzRnJvbURCW2ldLnByb2R1Y3RzW2lkTWFwW3ByLm5hbWVdXTtcclxuICAgICAgICAgICAgICAgICAgICAgIHByLnByaWNlLnNlbGVjdGVkID0ga1ByLnByaWNlLnNlbGVjdGVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgcHIuY291bnQgPSBrUHIuY291bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICBwci5wcmljZS5zZWxlY3RlZCA9IHByLnByaWNlW1wicC1rdFwiXTtcclxuICAgICAgICAgICAgICAgICAgICAgIHByLmNvdW50ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocHIpKTtcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICB2YXIgb3JkZXJLaXQgPSBvcmRlci5raXRzW2tpdC5uYW1lXTtcclxuICAgICAgICAgICAgICAgICAgaWYoIW9yZGVyS2l0KSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgICBraXRzRnJvbURCW2ldLmNvdW50ID0gKHR5cGVvZiBvcmRlcktpdC5jb3VudCA9PSBcIm51bWJlclwiKT9vcmRlcktpdC5jb3VudDowO1xyXG4gICAgICAgICAgICAgICAgICBraXRzRnJvbURCW2ldLnByaWNlID0gKHR5cGVvZiBvcmRlcktpdC5wcmljZSA9PSBcIm51bWJlclwiKT8ob3JkZXJLaXQucHJpY2UpOihraXRzRnJvbURCW2ldLnByaWNlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgIHZhciBuYW1lcyA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICBvcmRlcktpdC5wcm9kdWN0cy5mb3JFYWNoKChwciwgaSkgPT4gbmFtZXNbcHIubmFtZV0gPSBpKTtcclxuICAgICAgICAgICAgICAgICAgbGV0IHBjUHJpY2UgPSAwO1xyXG4gICAgICAgICAgICAgICAgICBsZXQgcGNXZWlnaHQgPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgICAga2l0LnByb2R1Y3RzLmZvckVhY2goKHByLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYobmFtZXNbcHIubmFtZV0gIT09IHVuZGVmaW5lZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICBwci5jb3VudCA9IG9yZGVyS2l0LnByb2R1Y3RzW25hbWVzW3ByLm5hbWVdXS5jb3VudDtcclxuICAgICAgICAgICAgICAgICAgICAgIHByLnByaWNlLnNlbGVjdGVkID0gb3JkZXJLaXQucHJvZHVjdHNbbmFtZXNbcHIubmFtZV1dLnByaWNlLnNlbGVjdGVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgaWYocHIuY291bnQgPiAwKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGNQcmljZSArPSBwci5jb3VudCpwci5wcmljZVtwci5wcmljZS5zZWxlY3RlZF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBjV2VpZ2h0ICs9IHByLndlaWdodCpwci5jb3VudDtcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgIHByLmNvdW50ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgIHByLnByaWNlLnNlbGVjdGVkID0gXCJwLWt0XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGtpdC5wcm9kdWN0c1tpXSA9IE9iamVjdC5hc3NpZ24oe30sIHByKTtcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICBraXQucGNQcmljZSA9IHBjUHJpY2U7XHJcbiAgICAgICAgICAgICAgICAgIGtpdC5wY1dlaWdodCA9IHBjV2VpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhraXQsIHBjUHJpY2UsIHBjV2VpZ2h0KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBraXRzRGF0YSA9IHt9O1xyXG5cclxuICAgICAgICAgICAgICAgIGtpdHNGcm9tREIuZm9yRWFjaChraXQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICBraXRzRGF0YVtraXQubmFtZV0gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGtpdCkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgb3V0Lmluc2VydERhdGEoXCJBV19raXRzXCIsIGtpdHNEYXRhKTtcclxuICAgICAgICAgICAgICAgIG91dC5pbnNlcnREYXRhKFwiQVdfU3VtUENcIiwgKGtpdHNGcm9tREIuZmlsdGVyKGtpdCA9PiBraXQuY291bnQgPiAwKS5tYXAoa2l0ID0+IGtpdC5jb3VudCooa2l0LnByaWNlP2tpdC5wcmljZTpraXQucGNQcmljZSkpLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApKSArIFwiIHVhaFwiKTtcclxuICAgICAgICAgICAgICAgIGlmKGNiKSBjYigpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRpc3BsYXlLaXRzKGN5Y2xlSUQpe1xyXG4gICAgdmFyIG91dCA9IG5ldyBDdXN0b21lclByb2ZpbGVPdXRwdXQoKTtcclxuICAgIHZhciBkYkN5Y2xlID0gbmV3IEN5Y2xlVGFibGVTUUwoKTtcclxuICAgIHZhciBkYktpdCA9IG5ldyBLaXRUYWJsZVNRTCgpO1xyXG5cclxuXHJcbiAgICBkYktpdC5zZWxlY3QoXCJjeWNsZUlEID0gP1wiLCBbY3ljbGVJRF0sIGtpdHMgPT4ge1xyXG4gICAgICB2YXIga2l0c0RhdGEgPSB7fTtcclxuXHJcbiAgICAgIChuZXcgUHJvZHVjdFRhYmxlU1FMKCkpLnNlbGVjdChcImN5Y2xlSUQgPSA/XCIsIFtjeWNsZUlEXSwgcHJvZHVjdHMgPT4ge1xyXG4gICAgICAgIGZvcih2YXIgayBpbiBraXRzKXtcclxuICAgICAgICAgIGxldCBraXQgPSBraXRzW2tdO1xyXG5cclxuICAgICAgICAgIGxldCBpZE1hcCA9IHt9O1xyXG4gICAgICAgICAga2l0LnByb2R1Y3RzLmZvckVhY2goKHByLCBpKSA9PiBpZE1hcFtwci5uYW1lXSA9IGkpO1xyXG4gICAgICAgICAga2l0LnByb2R1Y3RzID0gcHJvZHVjdHMubWFwKHByID0+IHtcclxuICAgICAgICAgICAgaWYodHlwZW9mIGlkTWFwW3ByLm5hbWVdICE9IFwidW5kZWZpbmVkXCIpe1xyXG4gICAgICAgICAgICAgIGxldCBrUHIgPSBraXQucHJvZHVjdHNbaWRNYXBbcHIubmFtZV1dO1xyXG4gICAgICAgICAgICAgIHByLnByaWNlLnNlbGVjdGVkID0ga1ByLnNlbGVjdGVkO1xyXG4gICAgICAgICAgICAgIHByLmNvdW50ID0ga1ByLmNvdW50O1xyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICBwci5wcmljZS5zZWxlY3RlZCA9IHByLnByaWNlW1wicC1rdFwiXTtcclxuICAgICAgICAgICAgICBwci5jb3VudCA9IDA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHByO1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgaWYoIWtpdHNba10uY291bnQpIGtpdHNba10uY291bnQgPSAwO1xyXG4gICAgICAgICAga2l0c0RhdGFba2l0c1trXVtcIm5hbWVcIl1dID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShraXQpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG91dC5pbnNlcnREYXRhKFwiQVdfa2l0c1wiLCBraXRzRGF0YSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDdXN0b21lcihjdXN0b21lcklEKXtcclxuICAgIHZhciBkYiA9IG5ldyBDdXN0b21lclRhYmxlU1FMKCk7XHJcbiAgICB2YXIgb3V0ID0gbmV3IEN1c3RvbWVyUHJvZmlsZU91dHB1dCgpO1xyXG4gICAgdmFyIF9pbiA9IG5ldyBDdXN0b21lclByb2ZpbGVJbnB1dCgpO1xyXG4gICAgaWYoX2luLnRha2VEYXRhKFwiV1BfSURcIikgPT0gY3VzdG9tZXJJRCkgdGhpcy5maWxsQ3VzdG9tZXJXaW4oLTEpO1xyXG4gICAgb3V0Lmluc2VydERhdGEoXCJXUF9UYmxfQ0RcIiwgY3VzdG9tZXJJRCk7XHJcbiAgICBkYi5kZWwoW2N1c3RvbWVySURdKTtcclxuICAgIGNvbnNvbGUubG9nKGN1c3RvbWVySUQpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlT3JkZXIob3JkZXJJRCl7XHJcbiAgICB2YXIgZGIgPSBuZXcgT3JkZXJUYWJsZVNRTCgpO1xyXG4gICAgdmFyIG91dCA9IG5ldyBDdXN0b21lclByb2ZpbGVPdXRwdXQoKTtcclxuICAgIGRiLmRlbChbb3JkZXJJRF0pO1xyXG4gICAgb3V0Lmluc2VydERhdGEoXCJXUF9UYmxfT0RcIiwgb3JkZXJJRCk7XHJcbiAgfVxyXG5cclxuXHJcbiAgZ2V0Q3VzdG9tZXJGcm9tUGFnZSgpe1xyXG4gICAgdmFyIGlucCA9IG5ldyBDdXN0b21lclByb2ZpbGVJbnB1dCgpO1xyXG4gICAgcmV0dXJuIG5ldyBDdXN0b21lck1vZGVsKHtcclxuICAgICAgaWQ6IGlucC50YWtlRGF0YShcIldQX0lEXCIpLFxyXG4gICAgICBmdWxsTmFtZTogaW5wLnRha2VEYXRhKFwiV1BfTm1cIiksXHJcbiAgICAgIHRlbGVwaG9uZXM6IFtcIlwiLCAuLi5pbnAudGFrZURhdGEoXCJXUF9UZWxcIikuZmlsdGVyKGVsID0+IGVsKV0sXHJcbiAgICAgIGFkcmVzc2VzOiBbXCJcIiwgLi4uaW5wLnRha2VEYXRhKFwiV1BfQWRyXCIpLmZpbHRlcihlbCA9PiBlbCldLFxyXG4gICAgICBlbWFpbDogaW5wLnRha2VEYXRhKFwiV1BfRS1tXCIpLFxyXG4gICAgICBub3RlczogaW5wLnRha2VEYXRhKFwiV1BfTnRcIiksXHJcbiAgICAgIHByZWZlcmVuY2VzOiBpbnAudGFrZURhdGEoXCJXUF9QclwiKSxcclxuICAgICAgc29jaWFsTWVkaWE6IGlucC50YWtlRGF0YShcIldQX1NNXCIpLFxyXG4gICAgICBhY3Rpdml0eTogaW5wLnRha2VEYXRhKFwiV1BfQWN0XCIpXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldE9yZGVyRnJvbVBhZ2UoYSwgcmV0dXJuT25seUtpdHMpe1xyXG4gICAgbGV0IGlucCA9IG5ldyBDdXN0b21lclByb2ZpbGVJbnB1dCgpO1xyXG4gICAgbGV0IG9yZGVyID0gbmV3IE9yZGVyTW9kZWwoe1xyXG4gICAgICBpZDogaW5wLnRha2VEYXRhKFwiQVdfSURcIiksXHJcbiAgICAgIGN5Y2xlSUQ6IGlucC50YWtlRGF0YShcIkFXX2NfaWRcIiksXHJcbiAgICAgIHRlbGVwaG9uZTogaW5wLnRha2VEYXRhKFwiQVdfVGVsXCIpLFxyXG4gICAgICBzb2NpYWxNZWRpYTogaW5wLnRha2VEYXRhKFwiQVdfU01cIiksXHJcbiAgICAgIGFkcmVzczogaW5wLnRha2VEYXRhKFwiQVdfQWRyXCIpLFxyXG4gICAgICBvcmRlck5vdGVzOiBpbnAudGFrZURhdGEoXCJBV19PTlwiKSxcclxuICAgICAgc3VtbWFyeTogaW5wLnRha2VEYXRhKFwiQVdfU3VtXCIpLFxyXG4gICAgICBiaWxsZWQ6IGlucC50YWtlRGF0YShcIkFXX0JpbGxcIiksXHJcbiAgICAgIGlzTm90VGhpczogaW5wLnRha2VEYXRhKFwiQVdfbl90aHNcIiksXHJcbiAgICAgIGN1c3RvbWVySUQ6IGlucC50YWtlRGF0YShcIldQX0lEXCIpLFxyXG4gICAgICBhbm90aGVyRnVsbE5hbWU6IGlucC50YWtlRGF0YShcIkFXX2FuX0ZOXCIpLFxyXG4gICAgICBhbm90aGVyVGVsZXBob25lOiBpbnAudGFrZURhdGEoXCJBV19hbl9UZWxcIiksXHJcbiAgICAgIGtpdHM6IGlucC50YWtlRGF0YShcIkFXX2tpdHNcIilcclxuICAgIH0pO1xyXG4gICAgaWYocmV0dXJuT25seUtpdHMpIHJldHVybiBvcmRlci5raXRzO1xyXG4gICAgbGV0IGN1c3RvbWVyID0gdGhpcy5nZXRDdXN0b21lckZyb21QYWdlKCk7XHJcbiAgICBjdXN0b21lci5wcmVmZXJlbmNlcyA9IGlucC50YWtlRGF0YShcIkFXX1ByXCIpO1xyXG5cclxuICAgIGxldCBbdGVscyxhZHJzLHNvY3NdID0gW1xyXG4gICAgICAgICAgICAgICAgICBjdXN0b21lci50ZWxlcGhvbmVzLmZpbmQodCA9PiB0PT1vcmRlci50ZWxlcGhvbmUpLFxyXG4gICAgICAgICAgICAgICAgICBjdXN0b21lci5hZHJlc3Nlcy5maW5kKG8gPT4gbz09b3JkZXIuYWRyZXNzKSxcclxuICAgICAgICAgICAgICAgICAgY3VzdG9tZXIuc29jaWFsTWVkaWEuZmluZChvID0+IG89PW9yZGVyLnNvY2lhbE1lZGlhKVxyXG4gICAgICAgICAgICAgICAgXTtcclxuICAgIGlmKCF0ZWxzKSBjdXN0b21lci50ZWxlcGhvbmVzLnB1c2gob3JkZXIudGVsZXBob25lKTtcclxuICAgIGlmKCFhZHJzKSBjdXN0b21lci5hZHJlc3Nlcy5wdXNoKG9yZGVyLmFkcmVzcyk7XHJcbiAgICBpZighc29jcykgY3VzdG9tZXIuc29jaWFsTWVkaWEucHVzaChvcmRlci5zb2NpYWxNZWRpYSk7XHJcblxyXG4gICAgY29uc3QgcGF5RGF0YSA9IGlucC50YWtlRGF0YShcIkFXX1BcIik7XHJcbiAgICBsZXQgcGF5cyA9IHBheURhdGEubWFwKGRhdGEgPT4gZGF0YVswXSk7XHJcbiAgICBsZXQgZGF0ZXMgPSBwYXlEYXRhLm1hcChkYXRhID0+IGRhdGFbMV0pO1xyXG5cclxuICAgIG9yZGVyLnBheXMgPSBwYXlzO1xyXG4gICAgb3JkZXIucGF5RGF0ZXMgPSBkYXRlcztcclxuXHJcbiAgICByZXR1cm4gW29yZGVyLCBjdXN0b21lcl07XHJcbiAgfVxyXG5cclxuICBzYXZlQ3VzdG9tZXIoY3VzdG9tZXIsIGNiKXtcclxuICAgIGxldCBkYiA9IG5ldyBDdXN0b21lclRhYmxlU1FMKCk7XHJcbiAgICBsZXQgaWQgPSBjdXN0b21lcltcImlkXCJdO1xyXG4gICAgaWYoaWQ9PS0xKSBkZWxldGUgY3VzdG9tZXJbXCJpZFwiXTtcclxuICAgIGRiLnNhdmUoW2N1c3RvbWVyXSwgY3VzdG9tZXJzID0+IHtcclxuICAgICAgY2IoY3VzdG9tZXJzWzBdKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2F2ZU9yZGVyKG9yZGVyLCBjYil7XHJcbiAgICBsZXQgZGIgPSBuZXcgT3JkZXJUYWJsZVNRTCgpO1xyXG4gICAgbGV0IGlkID0gb3JkZXJbXCJpZFwiXTtcclxuICAgIGlmKGlkPT0tMSkgZGVsZXRlIG9yZGVyW1wiaWRcIl07XHJcbiAgICBkYi5zYXZlKFtvcmRlcl0sIG9yZGVycyA9PiB7XHJcbiAgICAgIGNiKG9yZGVyc1swXSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZFRvQXJyYXkoaW5wTmFtZSwgZW1wKXtcclxuICAgIGlmKCFpbnBOYW1lKSByZXR1cm4gZmFsc2U7XHJcbiAgICBsZXQgaW5wID0gbmV3IEN1c3RvbWVyUHJvZmlsZUlucHV0KCk7XHJcbiAgICBsZXQgb3V0ID0gbmV3IEN1c3RvbWVyUHJvZmlsZU91dHB1dCgpO1xyXG4gICAgbGV0IHZhbHMgPSBpbnAudGFrZURhdGEoaW5wTmFtZSk7XHJcblxyXG4gICAgdmFsc1t2YWxzLmxlbmd0aF0gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHZhbHNbMF0pKTtcclxuICAgIHZhbHNbMF0gPSBlbXA7XHJcblxyXG4gICAgb3V0Lmluc2VydERhdGEoaW5wTmFtZSwgdmFscyk7XHJcbiAgfVxyXG5cclxuICBzZWxlY3RUYWJsZShzZWFyY2gpe1xyXG4gICAgQXJyYXkuZnJvbSgobmV3IEN1c3RvbWVyUHJvZmlsZUlucHV0KCkpLnRha2VEYXRhKFwiVGJsX3Jvd3NcIikpLmZvckVhY2godHIgPT4ge1xyXG4gICAgICB2YXIgaGFzU2VhcmNoZWQgPSBmYWxzZTtcclxuXHJcbiAgICAgIEFycmF5LmZyb20odHIucXVlcnlTZWxlY3RvckFsbChcInRkXCIpKS5mb3JFYWNoKHRkID0+IHtcclxuICAgICAgICBpZih0ZC5pbm5lckhUTUwuc2VhcmNoKHNlYXJjaCkgPiAtMSkgaGFzU2VhcmNoZWQgPSB0cnVlO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGlmKGhhc1NlYXJjaGVkKSB0ci5zdHlsZS5kaXNwbGF5ID0gXCJ0YWJsZS1yb3dcIjtcclxuICAgICAgZWxzZSB0ci5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICB1cGRhdGVPcmRlckZvcm0oa2l0cyl7XHJcbiAgICBsZXQgb3V0ID0gbmV3IEN1c3RvbWVyUHJvZmlsZU91dHB1dCgpO1xyXG4gICAgZm9yKHZhciBrIGluIGtpdHMpIGtpdHNba10ubmFtZSA9IGs7XHJcbiAgICBsZXQgZGF0YSA9IE9iamVjdC52YWx1ZXMoa2l0cykuZmlsdGVyKGtpdCA9PiBraXQuY291bnQgPiAwKS5tYXAoa2l0ID0+IFtraXQuY291bnQqKGtpdC5wcmljZT9raXQucHJpY2U6a2l0LnBjUHJpY2UpLCBraXQubmFtZV0pO1xyXG5cclxuICAgIG91dC5pbnNlcnREYXRhKFwiQVdfU3VtUENcIiwgKGRhdGEubWFwKGUgPT4gZVswXSkucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCkpICsgXCIgdWFoXCIpO1xyXG4gICAgZGF0YS5mb3JFYWNoKGQgPT4ge1xyXG4gICAgICBvdXQuaW5zZXJ0RGF0YShcIkFXX0t0UENcIiwgW2tpdHNbZFsxXV0ucGNQcmljZSwga2l0c1tkWzFdXS5wY1dlaWdodCwgZFsxXV0pO1xyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbn1cclxuIl19
