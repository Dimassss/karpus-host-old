var websql=function(){var e=!1,t=function(){},s=[],r={database:null,logInfo:!1,logErrors:!0,putSelectResultsInArray:!0,defaultFailureCallback:t};function a(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function n(e){return void 0===e}var o=new RegExp("^select\\s","i");function l(e){return o.test(e)}function c(e,t,s,a){var n=0,o=null,c=function(){e.executeSql(t[n].sql,t[n].data,i,u)},i=function(e,a){var i,u,f=[];if(r.logInfo&&console.log("Success processing: "+t[n].sql),r.putSelectResultsInArray&&l(t[n].sql))for(i=0,u=a.rows.length;i<u;i++)f[i]=a.rows.item(i);else f=null;o=t[n].success(e,a,f),n++,o&&$.isArray(o)?(t[n].data=o,o=null):o=null,t.length>n?c():s(e,a,f)},u=function(e,s){r.logErrors&&console.error("Error: "+s.message+" while processing statment "+(n+1)+": "+t[n].sql),a(s,t[n].sql)};c()}var i=function(e){if("string"==typeof e&&(e={sql:e}),this.sql=e.sql,this.data=e.data||s,this.success=e.success||t,"string"!=typeof this.sql||"function"!=typeof this.success||!$.isArray(this.data))throw new Error("Malformed sql object: "+this)};function u(e){var t,s;if("string"==typeof e)for(e=(e=a(e)).split(";"),t=1;t<e.length;t++){for(;e[t].split(/["]/gm).length%2==0||e[t].split(/[']/gm).length%2==0||e[t].split(/[`]/gm).length%2==0;)e.splice(t,2,e[t]+";"+e[t+1]);e[t]=a(e[t])+";",";"===e[t]&&e.splice(t,1)}for(!1==(s=e,"[object Array]"===Object.prototype.toString.call(s))&&(e=[new i(e)]),t=0;t<e.length;t++)e[t]=new i(e[t]);return e}return r.openDatabase=function(t,s,a,n){r.database=openDatabase(t,"",s,a),e="function"==typeof r.database.readTransaction,n&&n()},r.process=function(s,a,o){if(!r.database)return r.logErrors&&console.error("Error: Database needs to be opened before sql can be processed."),!1;var i=u(s);n(a)&&(a=t),n(o)&&(o=r.defaultFailureCallback),function(e){var t=0;do{if(!l(e[t].sql))return!1;t++}while(t<e.length);return!0}(i)&&e?r.database.readTransaction((function(e){c(e,i,a,o)}),o):r.database.transaction((function(e){c(e,i,a,o)}),o)},r.changeVersion=function(e,s,a,o,l){if(!r.database)return r.logErrors&&console.log("Error: Database needs to be opened before sql can be processed."),!1;if(r.database.version===e){var i=u(a);n(o)&&(o=t),n(l)&&(l=r.defaultFailureCallback),r.database.changeVersion(e,s,(function(e){c(e,i,o,l)}),l)}},r}();websql.openDatabase("karpus.com.ua","Database of crm logic",3145728);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlN0b3JhZ2Uvd2Vic3FsLmpzIl0sIm5hbWVzIjpbIndlYnNxbCIsInJlYWRUcmFuc2FjdGlvbkF2YWlsYWJsZSIsImRvTm90aGluZyIsImVtcHR5QXJyYXkiLCJkYXRhYmFzZSIsImxvZ0luZm8iLCJsb2dFcnJvcnMiLCJwdXRTZWxlY3RSZXN1bHRzSW5BcnJheSIsImRlZmF1bHRGYWlsdXJlQ2FsbGJhY2siLCJ0cmltIiwic3RyaW5nIiwicmVwbGFjZSIsImlzVW5kZWZpbmVkIiwib2JqIiwiaXNTZWxlY3RTdGF0ZW1lbnRSZWdleCIsIlJlZ0V4cCIsImlzU2VsZWN0U3RtdCIsInNxbHN0cmluZyIsInRlc3QiLCJzcWxQcm9jZXNzb3IiLCJ0cmFuc2FjdGlvbiIsInNxbE9iamVjdHMiLCJmaW5hbFN1Y2Nlc3MiLCJmYWlsdXJlIiwic2VxdWVuY2VOdW1iZXIiLCJkYXRhRm9yTmV4dFRyYW5zYWN0aW9uIiwicnVuVHJhbnNhY3Rpb24iLCJleGVjdXRlU3FsIiwic3FsIiwiZGF0YSIsInN1Y2Nlc3NDYWxsYmFjayIsImZhaWx1cmVDYWxsYmFjayIsInJlc3VsdHMiLCJpIiwibWF4Iiwicm93c0FycmF5IiwiY29uc29sZSIsImxvZyIsInJvd3MiLCJsZW5ndGgiLCJpdGVtIiwic3VjY2VzcyIsIiQiLCJpc0FycmF5IiwiZXJyb3IiLCJtZXNzYWdlIiwiU1FMT2JqZWN0Iiwib3B0aW9ucyIsInRoaXMiLCJFcnJvciIsInNxbE9iamVjdENyZWF0b3IiLCJzcWxJbnB1dCIsInNwbGl0Iiwic3BsaWNlIiwiT2JqZWN0IiwicHJvdG90eXBlIiwidG9TdHJpbmciLCJjYWxsIiwib3BlbkRhdGFiYXNlIiwibmFtZSIsImRpc3BsYXluYW1lIiwic2l6ZSIsIndoZW5PcGVuIiwicmVhZFRyYW5zYWN0aW9uIiwicHJvY2VzcyIsImZpbmFsU3VjY2Vzc0NhbGxiYWNrIiwiU1FMT2JqZWN0cyIsImFsbFN0YXRlbWVudHNBcmVTZWxlY3RPbmx5IiwiY2hhbmdlVmVyc2lvbiIs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QVFDLElBQUksb0VBRVQsRUFwQlAsR0FBR3JDLEVBQU9JLFNBQVNtRSxVQUFZRixFQUFXLENBQ3RDLElBQUloRCxFQUFhNkIsRUFBaUJDLEdBRS9CdkMsRUFBWXFELEtBQ2ZBLEVBQXVCL0QsR0FHcEJVLEVBQVltQixLQUNYQSxFQUFrQi9CLEVBQU9RLHdCQUc3QlIsRUFBT0ksU0FBU2dFLGNBQWNDLEVBQVlDLEdBQVksU0FBVWxELEdBQzVERCxFQUFhQyxFQUFhQyxFQUFZNEMsRUFBc0JsQyxLQUM3REEsS0FXUi9CLEVBaFZFLEdBbVZiQSxPQUFPMEQsYUFDRixnQkFDQSx3QkFDQSIsImZpbGUiOiJTdG9yYWdlL3dlYnNxbC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qICoqKioqIHdlYnNxbC5qcyAqKioqKipcclxuICogRGVzY3JpcHRpb246IEEgaGVscGVyIGphdmFzY3JpcHQgbW9kdWxlIGZvciBjcmVhdGluZyBhbmQgd29ya2luZyB3aXRoXHJcbiAqICAgICBIVE1MNSBXZWIgRGF0YWJhc2VzLlxyXG4gKlxyXG4gKiBMaWNlbnNlOiBNSVQgbGljZW5zZVxyXG4gKlxyXG4gKiBXZWJzaXRlOiBodHRwOi8va2VuY29yYmV0dGpyLmdpdGh1Yi5pby93ZWJzcWwvXHJcbiAqXHJcbiAqIEF1dGhvcnM6IEtlbiBDb3JiZXR0IEpyXHJcbiAqXHJcbiAqIFZlcnNpb24gMC45LjdcclxuICovXHJcblxyXG52YXIgd2Vic3FsID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciByZWFkVHJhbnNhY3Rpb25BdmFpbGFibGUgPSBmYWxzZTtcclxuICAgIHZhciBkb05vdGhpbmcgPSBmdW5jdGlvbiAoKSB7fTtcclxuICAgIHZhciBlbXB0eUFycmF5ID0gW107XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIGlzIHRoZSBjb3JlIG9iamVjdCB0aGF0IGdldHMgcmV0dXJuZWQgYnkgdGhpcyBzY3JpcHQuICBJdCBjb250YWluc1xyXG4gICAgICogY2VydGFpbiBjb25maWcgdmFsdWVzIHdoaWNoIGNhbiBiZSBtb2RpZmllZCBieSB1c2Vycy5cclxuICAgICAqXHJcbiAgICAgKiBAdHlwZSB7T2JqZWN0fVxyXG4gICAgICovXHJcbiAgICB2YXIgd2Vic3FsID0ge1xyXG4gICAgICAgIGRhdGFiYXNlOiBudWxsLFxyXG4gICAgICAgIGxvZ0luZm86IGZhbHNlLFxyXG4gICAgICAgIGxvZ0Vycm9yczogdHJ1ZSxcclxuICAgICAgICBwdXRTZWxlY3RSZXN1bHRzSW5BcnJheTogdHJ1ZSxcclxuICAgICAgICBkZWZhdWx0RmFpbHVyZUNhbGxiYWNrOiBkb05vdGhpbmdcclxuICAgIH07XHJcblxyXG4gICAgLy8gVXRpbGl0eSBGdW5jdGlvbnMgZnJvbSBVbmRlcnNjb3JlLmpzXHJcbiAgICBmdW5jdGlvbiB0cmltKHN0cmluZykge1xyXG4gICAgICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvXlxccysvLCBcIlwiKS5yZXBsYWNlKC9cXHMrJC8sIFwiXCIpO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gaXNBcnJheShvYmopIHtcclxuICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IEFycmF5XSc7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBpc1VuZGVmaW5lZChvYmopIHtcclxuICAgICAgICByZXR1cm4gb2JqID09PSB2b2lkIDA7XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGlzU2VsZWN0U3RhdGVtZW50UmVnZXggPSBuZXcgUmVnRXhwKCdec2VsZWN0XFxcXHMnLCAnaScpO1xyXG4gICAgZnVuY3Rpb24gaXNTZWxlY3RTdG10KHNxbHN0cmluZykge1xyXG4gICAgICAgIHJldHVybiBpc1NlbGVjdFN0YXRlbWVudFJlZ2V4LnRlc3Qoc3Fsc3RyaW5nKTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gUmV0dXJucyB0cnVlIGlmIGFsbCBTUUwgc3RhdGVtZW50IG9iamVjdHMgYXJlIFNFTEVDVCBzdGF0ZW1lbnRzLlxyXG4gICAgZnVuY3Rpb24gYWxsU3RhdGVtZW50c0FyZVNlbGVjdE9ubHkoU1FMT2JqZWN0cykge1xyXG4gICAgICAgIHZhciBpID0gMDtcclxuXHJcbiAgICAgICAgLy9Mb29wIG92ZXIgU1FMIG9iamVjdHMgZW5zdXJpbmcgdGhleSBhcmUgc2VsZWN0IHN0YXRlbWVudHNcclxuICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgIC8vSWYgdGhlIHNxbCBzdHJpbmcgaXMgbm90IGEgc2VsZWN0IHN0YXRlbWVudCByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgaWYgKCFpc1NlbGVjdFN0bXQoU1FMT2JqZWN0c1tpXS5zcWwpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgIH0gd2hpbGUgKGkgPCBTUUxPYmplY3RzLmxlbmd0aCk7XHJcblxyXG4gICAgICAgIC8vSWYgYWxsIHRoZSBzdGF0ZW1lbnRzIGhhcHBlbiB0byBiZSBzZWxlY3Qgc3RhdGVtZW50cyByZXR1cm4gdHJ1ZVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIHNxbFByb2Nlc3NvciBpcyB0aGUgY29yZSBvZiB3ZWJzcWwgYW5kIGlzIHJlc3BvbnNpYmxlIGZvciBleGVjdXRpbmcgYWxsXHJcbiAgICAgKiBzcWwgc3RhdGVtZW50cy4gIEl0IGlzIGEgcHJpdmF0ZSBmdW5jdGlvbiBhbmQgZG9lcyBhbGwgdGhlIGhlYXZ5IGxpZnRpbmcuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtICB7U1FMVHJhbnNhY3Rpb259IHRyYW5zYWN0aW9uICBBIHNxbCB0cmFuc2FjdGlvbiB0aGF0IHRoZSBzcWwgc3RhdGVtZW50cyBzaG91bGQgYmUgZXhlY3V0ZWRcclxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2l0aGluLlxyXG4gICAgICogQHBhcmFtICB7W1NRTE9iamVjdHNdfSAgIHNxbE9iamVjdHMgICBBbiBhcnJheSBvZiBvbmUgb3IgbW9yZSBTcWxPYmplY3RzLlxyXG4gICAgICogQHBhcmFtICB7W0Z1bmN0aW9uXX0gICAgIGZpbmFsU3VjY2VzcyBBIGZpbmFsIHN1Y2Nlc3MgY2FsbGJhY2sgdG8gZXhlY3V0ZSB3aGVuIGFsbCBzdGF0ZW1lbnRzIGhhdmVcclxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVlbiBleGVjdXRlZC5cclxuICAgICAqIEBwYXJhbSAge1tGdW5jdGlvbl19ICAgICBmYWlsdXJlICAgICAgQSBmYWlsdXJlIGNhbGxiYWNrLiAgRXhlY3V0ZWQgd2hlbmV2ZXIgYW55IG9mIHRoZSBwYXNzZWRcclxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVtZW50cyBlbmNvdW50ZXIgYW4gZXJyb3IuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHNxbFByb2Nlc3Nvcih0cmFuc2FjdGlvbiwgc3FsT2JqZWN0cywgZmluYWxTdWNjZXNzLCBmYWlsdXJlKSB7XHJcbiAgICAgICAgdmFyIHNlcXVlbmNlTnVtYmVyID0gMCxcclxuICAgICAgICAgICAgZGF0YUZvck5leHRUcmFuc2FjdGlvbiA9IG51bGwsXHJcbiAgICAgICAgICAgIHJ1blRyYW5zYWN0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24uZXhlY3V0ZVNxbChzcWxPYmplY3RzW3NlcXVlbmNlTnVtYmVyXS5zcWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNxbE9iamVjdHNbc2VxdWVuY2VOdW1iZXJdLmRhdGEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3NDYWxsYmFjayxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFpbHVyZUNhbGxiYWNrKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc3VjY2Vzc0NhbGxiYWNrID0gZnVuY3Rpb24gKHRyYW5zYWN0aW9uLCByZXN1bHRzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaSwgbWF4LCByb3dzQXJyYXkgPSBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZih3ZWJzcWwubG9nSW5mbyl7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJTdWNjZXNzIHByb2Nlc3Npbmc6IFwiICsgc3FsT2JqZWN0c1tzZXF1ZW5jZU51bWJlcl0uc3FsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvL1Byb2Nlc3MgdGhlIHJlc3VsdHMgb2YgYSBzZWxlY3QgcHV0dGluZyB0aGVtIGluIGEgbXVjaCBtb3JlIG1hbmFnZWFibGUgYXJyYXkgZm9ybS5cclxuICAgICAgICAgICAgICAgIGlmKHdlYnNxbC5wdXRTZWxlY3RSZXN1bHRzSW5BcnJheSAmJiBpc1NlbGVjdFN0bXQoc3FsT2JqZWN0c1tzZXF1ZW5jZU51bWJlcl0uc3FsKSl7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKGkgPSAwLCBtYXggPSByZXN1bHRzLnJvd3MubGVuZ3RoOyBpIDwgbWF4OyBpKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByb3dzQXJyYXlbaV0gPSByZXN1bHRzLnJvd3MuaXRlbShpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJvd3NBcnJheSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy9DYWxsIHRoZSBzdWNjZXNzIGNhbGxiYWNrIHByb3ZpZGVkIHdpdGggc3FsIG9iamVjdFxyXG4gICAgICAgICAgICAgICAgLy9JZiBhbiBhcnJheSBvZiBkYXRhIGlzIHJldHVybmVkIHVzZSB0aGF0IGRhdGEgYXMgdGhlXHJcbiAgICAgICAgICAgICAgICAvL2RhdGEgYXR0cmlidXRlIG9mIHRoZSBuZXh0IHRyYW5zYWN0aW9uXHJcbiAgICAgICAgICAgICAgICBkYXRhRm9yTmV4dFRyYW5zYWN0aW9uID0gc3FsT2JqZWN0c1tzZXF1ZW5jZU51bWJlcl0uc3VjY2Vzcyh0cmFuc2FjdGlvbiwgcmVzdWx0cywgcm93c0FycmF5KTtcclxuICAgICAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyKys7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YUZvck5leHRUcmFuc2FjdGlvbiAmJiAkLmlzQXJyYXkoZGF0YUZvck5leHRUcmFuc2FjdGlvbikpIHtcclxuICAgICAgICAgICAgICAgICAgICBzcWxPYmplY3RzW3NlcXVlbmNlTnVtYmVyXS5kYXRhID0gZGF0YUZvck5leHRUcmFuc2FjdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhRm9yTmV4dFRyYW5zYWN0aW9uID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YUZvck5leHRUcmFuc2FjdGlvbiA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHNxbE9iamVjdHMubGVuZ3RoID4gc2VxdWVuY2VOdW1iZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBydW5UcmFuc2FjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBmaW5hbFN1Y2Nlc3ModHJhbnNhY3Rpb24sIHJlc3VsdHMsIHJvd3NBcnJheSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGZhaWx1cmVDYWxsYmFjayA9IGZ1bmN0aW9uICh0cmFuc2FjdGlvbiwgZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGlmKHdlYnNxbC5sb2dFcnJvcnMpe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvcjogXCIgKyBlcnJvci5tZXNzYWdlICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiIHdoaWxlIHByb2Nlc3Npbmcgc3RhdG1lbnQgXCIgKyAoc2VxdWVuY2VOdW1iZXIgKyAxKStcIjogXCIgKyBzcWxPYmplY3RzW3NlcXVlbmNlTnVtYmVyXS5zcWwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZmFpbHVyZShlcnJvciwgc3FsT2JqZWN0c1tzZXF1ZW5jZU51bWJlcl0uc3FsKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcnVuVHJhbnNhY3Rpb24oKTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIFNRTE9iamVjdCA9IGZ1bmN0aW9uKG9wdGlvbnMpe1xyXG4gICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgc3FsOiBvcHRpb25zXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zcWwgPSBvcHRpb25zLnNxbDtcclxuICAgICAgICB0aGlzLmRhdGEgPSBvcHRpb25zLmRhdGEgfHwgZW1wdHlBcnJheTtcclxuICAgICAgICB0aGlzLnN1Y2Nlc3MgPSBvcHRpb25zLnN1Y2Nlc3MgfHwgZG9Ob3RoaW5nO1xyXG5cclxuICAgICAgICAgLy8gQ2hlY2sgdG8gc2VlIHRoYXQgdGhlIHNxbCBvYmplY3QgaXMgZm9ybWF0ZWQgY29ycmVjdGx5LlxyXG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5zcWwgICAgICE9PSBcInN0cmluZ1wiICAgfHxcclxuICAgICAgICAgICAgdHlwZW9mIHRoaXMuc3VjY2VzcyAhPT0gXCJmdW5jdGlvblwiIHx8XHJcbiAgICAgICAgICAgICEkLmlzQXJyYXkodGhpcy5kYXRhKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJNYWxmb3JtZWQgc3FsIG9iamVjdDogXCIgKyB0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIHNxbE9iamVjdENyZWF0b3Ioc3FsSW5wdXQpIHtcclxuICAgICAgICB2YXIgaTtcclxuICAgICAgICBpZiAodHlwZW9mIHNxbElucHV0ID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgIHNxbElucHV0ID0gdHJpbShzcWxJbnB1dCk7XHJcblxyXG4gICAgICAgICAgICAvL1NlcGFyYXRlIHNxbCBzdGF0ZW1lbnRzIGJ5IHRoZWlyIGVuZGluZyBzZW1pY29sb25cclxuICAgICAgICAgICAgc3FsSW5wdXQgPSBzcWxJbnB1dC5zcGxpdCgnOycpO1xyXG5cclxuICAgICAgICAgICAgZm9yKGkgPSAxOyBpIDwgc3FsSW5wdXQubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICAgICAgLy9FbnN1cmUgc2VtaWNvbG9ucyB3aXRoaW4gcXVvdGVzIGFyZSBwdXQgYmFjayBpblxyXG4gICAgICAgICAgICAgICAgd2hpbGUoc3FsSW5wdXRbaV0uc3BsaXQoL1tcIl0vZ20pLmxlbmd0aCAlIDIgPT09IDAgfHxcclxuICAgICAgICAgICAgICAgICAgICAgIHNxbElucHV0W2ldLnNwbGl0KC9bJ10vZ20pLmxlbmd0aCAlIDIgPT09IDAgfHxcclxuICAgICAgICAgICAgICAgICAgICAgIHNxbElucHV0W2ldLnNwbGl0KC9bYF0vZ20pLmxlbmd0aCAlIDIgPT09IDApe1xyXG4gICAgICAgICAgICAgICAgICAgIHNxbElucHV0LnNwbGljZShpLDIsc3FsSW5wdXRbaV0gKyBcIjtcIiArIHNxbElucHV0W2krMV0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy9BZGQgYmFjayB0aGUgc2VtaWNvbG9uIGF0IHRoZSBlbmQgb2YgdGhlIGxpbmVcclxuICAgICAgICAgICAgICAgIHNxbElucHV0W2ldID0gdHJpbShzcWxJbnB1dFtpXSkgKyAnOyc7XHJcbiAgICAgICAgICAgICAgICAvL0dldCByaWQgb2YgYW55IGVtcHR5IHN0YXRlbWVudHNcclxuICAgICAgICAgICAgICAgIGlmKHNxbElucHV0W2ldID09PSAnOycpe1xyXG4gICAgICAgICAgICAgICAgICAgIHNxbElucHV0LnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZihpc0FycmF5KHNxbElucHV0KSA9PT0gZmFsc2Upe1xyXG4gICAgICAgICAgICAvLyBBdCB0aGlzIHBvaW50IHRoZSB1c2VyIGhhcyBtb3N0IGxpa2VseSBwYXNzZWQgaW4gYSBzcWwgb2JqZWN0XHJcbiAgICAgICAgICAgIC8vIFdlIHB1dCBpdCBpbnRvIGFuIGFycmF5IHNvIGl0IHdpbGwgZml0IHRoZSBub3JtYWwgZm9ybWF0XHJcbiAgICAgICAgICAgIHNxbElucHV0ID0gW25ldyBTUUxPYmplY3Qoc3FsSW5wdXQpXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IHNxbElucHV0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHNxbElucHV0W2ldID0gbmV3IFNRTE9iamVjdChzcWxJbnB1dFtpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzcWxJbnB1dDtcclxuICAgIH07XHJcblxyXG4gICAgd2Vic3FsLm9wZW5EYXRhYmFzZSA9ICBmdW5jdGlvbiAobmFtZSwgZGlzcGxheW5hbWUsIHNpemUsIHdoZW5PcGVuKSB7XHJcbiAgICAgICAgd2Vic3FsLmRhdGFiYXNlID0gb3BlbkRhdGFiYXNlKG5hbWUsIFwiXCIsIGRpc3BsYXluYW1lLCBzaXplKTtcclxuICAgICAgICByZWFkVHJhbnNhY3Rpb25BdmFpbGFibGUgPSB0eXBlb2Ygd2Vic3FsLmRhdGFiYXNlLnJlYWRUcmFuc2FjdGlvbiA9PT0gJ2Z1bmN0aW9uJztcclxuICAgICAgICBpZiAod2hlbk9wZW4pIHtcclxuICAgICAgICAgICAgd2hlbk9wZW4oKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLypcclxuICAgICAqICBBcmd1bWVudHM6XHJcbiAgICAgKiAgMS4gc3FsID0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIH4gdGhlcmUgYXJlIGZvdXIgd2F5cyB0byBwYXNzIHNxbFxyXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlbWVudHMgdG8gd2Vic3FsLmpzXHJcbiAgICAgKiAgICAgYS4ge29iamVjdCBTUUxTdGF0ZW1lbnRPYmplY3R9ICAgIH4gYSBzaW5nbGUgc3FsIHN0YXRlbWVudCBvYmplY3RcclxuICAgICAqICAgICAgICAgICBvclxyXG4gICAgICogICAgIGIuIFthcnJheSBTUUxTdGF0ZW1lbnRPYmplY3QocyldICB+IGEgY29sbGVjdGlvbiBvZiBTUUwgc3RhdGVtZW50IG9iamVjdHNcclxuICAgICAqICAgICAgICAgICBvclxyXG4gICAgICogICAgIGMuIFwic3RyaW5nIFNRTCBTdGF0ZW1lbnQocylcIiAgICAgIH4gYSBTUUwgc3RyaW5nIHRvIGJlIHNwbGl0IGludG8gaW5kaXZpZHVhbFxyXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlbWVudHMgYXQgdGhlICc7JyBjaGFyYWN0ZXJcclxuICAgICAqICAgICAgICAgICBvclxyXG4gICAgICogICAgIGQuIFthcnJheSBTUWwgU3RhdGVtZW50KHMpXSAgICAgICB+IGEgY29sbGVjdGlvbiBvZiBTUUwgc3RyaW5nc1xyXG4gICAgICpcclxuICAgICAqICAyLiBmaW5hbFN1Y2Nlc3NDYWxsYmFjayA9IChmdW5jdGlvbikgfiBjYWxsZWQgYWZ0ZXIgYWxsIHNxbCBzdGF0ZW1lbnRzIGhhdmVcclxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWVuIHByb2Nlc3NlZC4gIE9wdGlvbmFsLlxyXG4gICAgICpcclxuICAgICAqICAzLiBmYWlsdXJlQ2FsbGJhY2sgPSAgICAgIChmdW5jdGlvbikgfiBjYWxsZWQgaWYgYW55IG9mIHRoZSBzcWwgc3RhdGVtZW50c1xyXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhaWxzLiAgQSBkZWZhdWx0IG9uZSBpcyB1c2VkIGlmIG5vbmVcclxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpcyBwcm92aWRlZC4gIE9wdGlvbmFsLlxyXG4gICAgICpcclxuICAgICAqICBTUUxTdGF0ZW1lbnRPYmplY3Q6XHJcbiAgICAgKiAge1xyXG4gICAgICogICBzcWw6IFwic3RyaW5nXCIsICAgICAgICFSZXF1aXJlZCEgIH4gWW91ciBzcWwgYXMgYSBzdHJpbmdcclxuICAgICAqICAgZGF0YTogW2FycmF5XSwgICAgICAgIE9wdGlvbmFsICAgfiBUaGUgYXJyYXkgb2YgZGF0YSB0byBiZSBzZXF1ZW50aWFsbHlcclxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnNlcnRlZCBpbnRvIHlvdXIgc3FsIGF0IHRoZSA/XHJcbiAgICAgKiAgIHN1Y2Nlc3M6IChmdW5jdGlvbiksICBPcHRpb25hbCAgIH4gQSBmdW5jdGlvbiB0byBiZSBjYWxsZWQgaWYgdGhpc1xyXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGl2aWR1YWwgc3FsIHN0YXRlbWVudCBzdWNjZWVkc1xyXG4gICAgICogICBmYWlsdXJlOiAoZnVuY3Rpb24pLCAgT3B0aW9uYWwgICB+IEEgZnVuY3Rpb24gdG8gYmUgY2FsbGVkIGlmIHRoaXNcclxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRpdmlkdWFsIHNxbCBzdGF0ZW1lbnQgZmFpbHNcclxuICAgICAqICB9XHJcbiAgICAgKlxyXG4gICAgICogIFVzYWdlOlxyXG4gICAgICogIHdlYnNxbC5wcm9jZXNzKFxyXG4gICAgICogICAgICB7XHJcbiAgICAgKiAgICAgICAgIHNxbDogXCJVUERBVEUgdXNlcnMgU0VUIC4uLlwiLFxyXG4gICAgICogICAgICAgICBkYXRhOiBbXSxcclxuICAgICAqICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oKXt9LFxyXG4gICAgICogICAgICAgICBmYWlsdXJlOiBmdW5jdGlvbigpe31cclxuICAgICAqICAgICAgfSxcclxuICAgICAqICAgICAgZnVuY3Rpb24oKXt9LCAvLyBmaW5hbFN1Y2Nlc3NDYWxsYmFja1xyXG4gICAgICogICAgICBmdW5jdGlvbigpe30gIC8vIGZhaWx1cmVDYWxsYmFja1xyXG4gICAgICogICk7XHJcbiAgICAgKlxyXG4gICAgICovXHJcbiAgICB3ZWJzcWwucHJvY2VzcyA9IGZ1bmN0aW9uIChzcWxJbnB1dCwgZmluYWxTdWNjZXNzQ2FsbGJhY2ssIGZhaWx1cmVDYWxsYmFjaykge1xyXG4gICAgICAgIGlmICh3ZWJzcWwuZGF0YWJhc2UpIHtcclxuICAgICAgICAgICAgdmFyIHNxbE9iamVjdHMgPSBzcWxPYmplY3RDcmVhdG9yKHNxbElucHV0KTtcclxuXHJcbiAgICAgICAgICAgIGlmKGlzVW5kZWZpbmVkKGZpbmFsU3VjY2Vzc0NhbGxiYWNrKSl7XHJcbiAgICAgICAgICAgICAgICBmaW5hbFN1Y2Nlc3NDYWxsYmFjayA9IGRvTm90aGluZztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYoaXNVbmRlZmluZWQoZmFpbHVyZUNhbGxiYWNrKSl7XHJcbiAgICAgICAgICAgICAgICBmYWlsdXJlQ2FsbGJhY2sgPSB3ZWJzcWwuZGVmYXVsdEZhaWx1cmVDYWxsYmFjaztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGFsbFN0YXRlbWVudHNBcmVTZWxlY3RPbmx5KHNxbE9iamVjdHMpICYmIHJlYWRUcmFuc2FjdGlvbkF2YWlsYWJsZSkge1xyXG4gICAgICAgICAgICAgICAgd2Vic3FsLmRhdGFiYXNlLnJlYWRUcmFuc2FjdGlvbihmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBzcWxQcm9jZXNzb3IodHJhbnNhY3Rpb24sIHNxbE9iamVjdHMsIGZpbmFsU3VjY2Vzc0NhbGxiYWNrLCBmYWlsdXJlQ2FsbGJhY2spO1xyXG4gICAgICAgICAgICAgICAgfSwgZmFpbHVyZUNhbGxiYWNrKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHdlYnNxbC5kYXRhYmFzZS50cmFuc2FjdGlvbihmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBzcWxQcm9jZXNzb3IodHJhbnNhY3Rpb24sIHNxbE9iamVjdHMsIGZpbmFsU3VjY2Vzc0NhbGxiYWNrLCBmYWlsdXJlQ2FsbGJhY2spO1xyXG4gICAgICAgICAgICAgICAgfSwgZmFpbHVyZUNhbGxiYWNrKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIERhdGFiYXNlIGhhc24ndCBiZWVuIG9wZW5lZC5cclxuICAgICAgICAgICAgaWYod2Vic3FsLmxvZ0Vycm9ycyl7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3I6IERhdGFiYXNlIG5lZWRzIHRvIGJlIG9wZW5lZCBiZWZvcmUgc3FsIGNhbiBiZSBwcm9jZXNzZWQuXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8qIFRoaXMgaXMgdGhlIHNhbWUgYXMgd2Vic3FsLnByb2Nlc3MgYnV0IHVzZWQgd2hlbiB5b3Ugd2FudCB0byBjaGFuZ2UgdGhlXHJcbiAgICAgKiB2ZXJzaW9uIG9mIHlvdXIgZGF0YWJhc2UuICBJZiB0aGUgZGF0YWJhc2UgdmVyc2lvbiBtYXRjaGVzIHRoZSBvbGRWZXJzaW9uXHJcbiAgICAgKiBwYXNzZWQgdG8gdGhlIGZ1bmN0aW9uIHRoZSBzdGF0ZW1lbnRzIHBhc3NlZCB0byB0aGUgZnVuY3Rpb24gYXJlXHJcbiAgICAgKiBwcm9jZXNzZWQgYW5kIHRoZSB2ZXJzaW9uIG9mIHRoZSBkYXRhYmFzZSBpcyBjaGFuZ2VkIHRvIHRoZSBuZXcgdmVyc2lvbi5cclxuICAgICAqXHJcbiAgICAgKiAgQXJndW1lbnRzOlxyXG4gICAgICogIDEuIG9sZFZlcnNpb24gPSBcIlN0cmluZ1wiICAgICAgICAgICAgIH4gdGhlIG9sZCB2ZXJzaW9uIHRvIHVwZ3JhZGVcclxuICAgICAqICAyLiBuZXdWZXJzaW9uID0gXCJTdHJpbmdcIiAgICAgICAgICAgICB+IHRoZSBuZXcgdmVyc2lvbiBhZnRlciB0aGUgdXBncmFkZVxyXG4gICAgICogIDMuIHNxbCA9ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB+IHRoZXJlIGFyZSBmb3VyIHdheXMgdG8gcGFzcyBzcWxcclxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZW1lbnRzIHRvIHdlYnNxbC5qc1xyXG4gICAgICogICAgIGEuIHtvYmplY3QgU1FMU3RhdGVtZW50T2JqZWN0fSAgICB+IGEgc2luZ2xlIHNxbCBzdGF0ZW1lbnQgb2JqZWN0XHJcbiAgICAgKiAgICAgICAgICAgb3JcclxuICAgICAqICAgICBiLiBbYXJyYXkgU1FMU3RhdGVtZW50T2JqZWN0KHMpXSAgfiBhIGNvbGxlY3Rpb24gb2YgU1FMIHN0YXRlbWVudCBvYmplY3RzXHJcbiAgICAgKiAgICAgICAgICAgb3JcclxuICAgICAqICAgICBjLiBcInN0cmluZyBTUUwgU3RhdGVtZW50KHMpXCIgICAgICB+IGEgU1FMIHN0cmluZyB0byBiZSBzcGxpdCBpbnRvIGluZGl2aWR1YWxcclxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZW1lbnRzIGF0IHRoZSAnOycgY2hhcmFjdGVyXHJcbiAgICAgKiAgICAgICAgICAgb3JcclxuICAgICAqICAgICBkLiBbYXJyYXkgU1FsIFN0YXRlbWVudChzKV0gICAgICAgfiBhIGNvbGxlY3Rpb24gb2YgU1FMIHN0cmluZ3NcclxuICAgICAqXHJcbiAgICAgKiAgNC4gZmluYWxTdWNjZXNzQ2FsbGJhY2sgPSAoZnVuY3Rpb24pIH4gY2FsbGVkIGFmdGVyIGFsbCBzcWwgc3RhdGVtZW50cyBoYXZlXHJcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVlbiBwcm9jZXNzZWQuICBPcHRpb25hbC5cclxuICAgICAqXHJcbiAgICAgKiAgNS4gZmFpbHVyZUNhbGxiYWNrID0gICAgICAoZnVuY3Rpb24pIH4gY2FsbGVkIGlmIGFueSBvZiB0aGUgc3FsIHN0YXRlbWVudHNcclxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWlscy4gIEEgZGVmYXVsdCBvbmUgaXMgdXNlZCBpZiBub25lXHJcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXMgcHJvdmlkZWQuICBPcHRpb25hbC5cclxuICAgICAqXHJcbiAgICAgKiAgU1FMU3RhdGVtZW50T2JqZWN0OlxyXG4gICAgICogIHtcclxuICAgICAqICAgc3FsOiBcInN0cmluZ1wiLCAgICAgICAhUmVxdWlyZWQhICB+IFlvdXIgc3FsIGFzIGEgc3RyaW5nXHJcbiAgICAgKiAgIGRhdGE6IFthcnJheV0sICAgICAgICBPcHRpb25hbCAgIH4gVGhlIGFycmF5IG9mIGRhdGEgdG8gYmUgc2VxdWVudGlhbGx5XHJcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zZXJ0ZWQgaW50byB5b3VyIHNxbCBhdCB0aGUgP1xyXG4gICAgICogICBzdWNjZXNzOiAoZnVuY3Rpb24pLCAgT3B0aW9uYWwgICB+IEEgZnVuY3Rpb24gdG8gYmUgY2FsbGVkIGlmIHRoaXNcclxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRpdmlkdWFsIHNxbCBzdGF0ZW1lbnQgc3VjY2VlZHNcclxuICAgICAqICAgZmFpbHVyZTogKGZ1bmN0aW9uKSwgIE9wdGlvbmFsICAgfiBBIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCBpZiB0aGlzXHJcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kaXZpZHVhbCBzcWwgc3RhdGVtZW50IGZhaWxzXHJcbiAgICAgKiAgfVxyXG4gICAgICpcclxuICAgICAqICBVc2FnZTpcclxuICAgICAqICB3ZWJzcWwuY2hhbmdlVmVyc2lvbihcclxuICAgICAqICAgICAgXCIxLjBcIiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9sZFZlcnNpb25cclxuICAgICAqICAgICAgXCIyLjBcIiwgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5ld1ZlcnNpb25cclxuICAgICAqICAgICAgW3sgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzcWxcclxuICAgICAqICAgICAgICAgc3FsOiBcIkFMVEVSIFRBQkxFIHVzZXJzIC4uLlwiLFxyXG4gICAgICogICAgICAgICBkYXRhOiBbXSxcclxuICAgICAqICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oKXt9LFxyXG4gICAgICogICAgICAgICBmYWlsdXJlOiBmdW5jdGlvbigpe31cclxuICAgICAqICAgICAgIH0sXHJcbiAgICAgKiAgICAgICB7XHJcbiAgICAgKiAgICAgICAgIHNxbDogXCJVUERBVEUgdXNlcnMgLi4uXCIsXHJcbiAgICAgKiAgICAgICAgIGRhdGE6IFtdLFxyXG4gICAgICogICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbigpe30sXHJcbiAgICAgKiAgICAgICAgIGZhaWx1cmU6IGZ1bmN0aW9uKCl7fVxyXG4gICAgICogICAgICAgfV0sXHJcbiAgICAgKiAgICAgIGZ1bmN0aW9uKCl7fSwgICAgICAgICAgICAgICAgICAgICAgLy8gZmluYWxTdWNjZXNzQ2FsbGJhY2tcclxuICAgICAqICAgICAgZnVuY3Rpb24oKXt9ICAgICAgICAgICAgICAgICAgICAgICAvLyBmYWlsdXJlQ2FsbGJhY2tcclxuICAgICAqICApO1xyXG4gICAgICpcclxuICAgICAqL1xyXG4gICAgd2Vic3FsLmNoYW5nZVZlcnNpb24gPSBmdW5jdGlvbiAob2xkVmVyc2lvbiwgbmV3VmVyc2lvbiwgc3FsSW5wdXQsIGZpbmFsU3VjY2Vzc0NhbGxiYWNrLCBmYWlsdXJlQ2FsbGJhY2spIHtcclxuICAgICAgICBpZiAod2Vic3FsLmRhdGFiYXNlKSB7XHJcbiAgICAgICAgICAgIGlmKHdlYnNxbC5kYXRhYmFzZS52ZXJzaW9uID09PSBvbGRWZXJzaW9uKXtcclxuICAgICAgICAgICAgICAgIHZhciBzcWxPYmplY3RzID0gc3FsT2JqZWN0Q3JlYXRvcihzcWxJbnB1dCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoaXNVbmRlZmluZWQoZmluYWxTdWNjZXNzQ2FsbGJhY2spKXtcclxuICAgICAgICAgICAgICAgIGZpbmFsU3VjY2Vzc0NhbGxiYWNrID0gZG9Ob3RoaW5nO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmKGlzVW5kZWZpbmVkKGZhaWx1cmVDYWxsYmFjaykpe1xyXG4gICAgICAgICAgICAgICAgICAgIGZhaWx1cmVDYWxsYmFjayA9IHdlYnNxbC5kZWZhdWx0RmFpbHVyZUNhbGxiYWNrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHdlYnNxbC5kYXRhYmFzZS5jaGFuZ2VWZXJzaW9uKG9sZFZlcnNpb24sIG5ld1ZlcnNpb24sIGZ1bmN0aW9uICh0cmFuc2FjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHNxbFByb2Nlc3Nvcih0cmFuc2FjdGlvbiwgc3FsT2JqZWN0cywgZmluYWxTdWNjZXNzQ2FsbGJhY2ssIGZhaWx1cmVDYWxsYmFjayk7XHJcbiAgICAgICAgICAgICAgICB9LCBmYWlsdXJlQ2FsbGJhY2spO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gRGF0YWJhc2UgaGFzbid0IGJlZW4gb3BlbmVkLlxyXG4gICAgICAgICAgICBpZih3ZWJzcWwubG9nRXJyb3JzKXtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3I6IERhdGFiYXNlIG5lZWRzIHRvIGJlIG9wZW5lZCBiZWZvcmUgc3FsIGNhbiBiZSBwcm9jZXNzZWQuXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHJldHVybiB3ZWJzcWw7XHJcbn0pKCk7XHJcblxyXG53ZWJzcWwub3BlbkRhdGFiYXNlKFxyXG4gICAgIFwia2FycHVzLmNvbS51YVwiLFxyXG4gICAgIFwiRGF0YWJhc2Ugb2YgY3JtIGxvZ2ljXCIsXHJcbiAgICAgMyoxMDI0KjEwMjQpO1xyXG4iXX0=
