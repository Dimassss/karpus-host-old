class TableSQL{constructor(r,s,t){this.k=r,this.table=s,this.v=t,websql.process(`CREATE TABLE IF NOT EXISTS ${s}(${function(){var r="";for(var s in t)r+=t[s]+",";return r.slice(0,-1)}()})`)}l(r,s){let t=this;for(var e=[],n=[],a=0;a<r.length;a++)r[a]&&(n[n.length]={sql:`SELECT * FROM ${t.table} WHERE ${t.k} in (${function(){for(var s="",t=0;t<r.length;t++)s+="?,";return s.slice(0,-1)}()})`,data:r,success:(r,s)=>{for(var t=0;t<s.rows.length;t++){var n=s.rows.item(t);for(var a in e[t]={},n)e[t][a]=n[a]}}});n.length>0?websql.process(n,()=>{s(e)}):s(e)}save(r,s){for(var t=this.k,e=this.table,n=this.v,a=[],l=0,i=[],o=0;o<r.length;o++)r[o]&&!r[o][t]?(a[a.length]=o-1,i[i.length]={sql:`INSERT INTO ${e} ${function(){var r="(",s="(";for(var e in n)e!=t&&(r+=e+",",s+="?,");return`${r=r.slice(0,-1)+")"} VALUES ${s=s.slice(0,-1)+")"}`}()}`,data:function(){var s=[],e=r[o].toDB();for(var a in n)a!=t&&(s[s.length]=e[a]);return s}(),success:(s,e)=>{r[a[l]+1][t]=e.insertId,l++}}):r[o]&&(i[i.length]={sql:`UPDATE ${e} SET ${function(){var r="";for(var s in n)s!=t&&s!=Object.keys(t)[0]&&(r+=`${s} = ?,`);return r.slice(0,-1)}()} WHERE ${t} = ${r[o][t]}`,data:function(){var s=[],e=r[o].toDB();for(var a in n)a!=t&&(s[s.length]=e[a]);return s}()});i.length>0?websql.process(i,()=>{s(r)}):s(r)}del(r){r=r.map(r=>parseInt(r));for(var s=this.k,t=this.table,e=0;e<r.length;e++)r[e]&&websql.process({sql:`DELETE FROM ${t} WHERE ${s} = ?`,data:[r[e]]})}sl(r,s,t){var e=[];websql.process({sql:`SELECT * FROM ${this.table} WHERE ${r}`,data:s,success:(r,s)=>{for(var t=0;t<s.rows.length;t++){var n=s.rows.item(t);for(var a in e[t]=[],n)e[t][a]=n[a]}}},()=>t(e))}}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlN0b3JhZ2UvVGFibGVTUUwuanMiXSwibmFtZXMiOlsiVGFibGVTUUwiLCJbb2JqZWN0IE9iamVjdF0iLCJrIiwidGFibGUiLCJ2IiwidGhpcyIsIndlYnNxbCIsInByb2Nlc3MiLCJjb2x1bW5zIiwiYyIsInNsaWNlIiwia2V5cyIsImNiIiwiX3RoaXMiLCJyZWNvcmRzIiwicHJvY2Vzc0RBVEEiLCJpIiwibGVuZ3RoIiwic3FsIiwiciIsImoiLCJkYXRhIiwic3VjY2VzcyIsInRyIiwicm93cyIsInJvdyIsIml0ZW0iLCJjb2wiLCJmb3JJIiwiY291bnRlciIsImNvbHMiLCJ2YWxzIiwidG9kYiIsInRvREIiLCJpbnNlcnRJZCIsIk9iamVjdCIsIm1hcCIsImtleSIsInBhcnNlSW50Iiwid2hlcmUiXSwibWFwcGluZ3MiOiJBQXlCQSxNQUFNQSxTQUNKQyxZQUFZQyxFQUFHQyxFQUFPQyxHQUNSQyxLQUNOSCxFQUFJQSxFQURFRyxLQUVORixNQUFRQSxFQUZGRSxLQUdORCxFQUFJQSxFQUVWRSxPQUFPQyxRQUFRLDhCQUE4QkosS0FBUyxXQUNwRCxJQUFJSyxFQUFVLEdBQ2QsSUFBSSxJQUFJQyxLQUFLTCxFQUNYSSxHQUFXSixFQUFFSyxHQUFLLElBRXBCLE9BQU9ELEVBQVFFLE1BQU0sR0FBSSxHQUwyQixPQVV4RFQsRUFBRVUsRUFBTUMsR0FDTixJQUFJQyxFQUFRUixLQUdaLElBRkEsSUFBSVMsRUFBVSxHQUNWQyxFQUFjLEdBQ1ZDLEVBQUksRUFBR0EsRUFBSUwsRUFBS00sT0FBUUQsSUFBUUwsRUFBS0ssS0FDM0NELEVBQVlBLEVBQVlFLFFBQVUsQ0FDaENDLElBQU8saUJBQWlCTCxFQUFNVixlQUFlVSxFQUFNWCxTQUFTLFdBRTFELElBREEsSUFBSWlCLEVBQUksR0FDQUMsRUFBSSxFQUFHQSxFQUFJVCxFQUFLTSxPQUFRRyxJQUFLRCxHQUFLLEtBQzFDLE9BQU9BLEVBQUVULE1BQU0sR0FBSSxHQUh1QyxNQUs1RFcsS0FBUVYsRUFDUlcsUUFB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LEVBQVFFLEdBQUdXLEdBQU9GLEVBQUlFLE1BSTNCLElBQU1mLEVBQUdFIiwiZmlsZSI6IlN0b3JhZ2UvVGFibGVTUUwuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuQGNsYXNzIFRhYmxlU1FMLCBwYXJlbnRcclxuQHBhcmFtc1xyXG4gIEBwYXJhbSB7U3RyaW5nfSBrID0+IGNvbHVtbk5hbWUgb2YgcHJpbWFyeUtleS4gRXhhbXBsZTogayA9IFwiaWRcIlxyXG4gIEBwYXJhbSB7U3RyaW5nfSB0YWJsZSA9PiB0YWJsZSBuYW1lIG9mIGN1cnJlbnQgb2JqZWN0IGluIGRiLiBFeGFtcGxlOiB0YWJsZSA9IFwiY3VzdG9tZXJzXCJcclxuICBAcGFyYW0ge09iamVjdH0gdiA9PiBIYXNoTWFwIG9mIGNvbHVtbiBuYW1lcyBpbiBvYmplY3QgYW5kIHNxbCBzdHJpbmcgdG8gY3JlYXRlIHRoaXMgY29sdW1uLiBFeGFtcGxlOiB2ID0ge25hbWU6IFwiXHRgbmFtZWAgVkFSQ0hBUig4MCkgTk9UIE5VTExcIn1cclxuICAgICAgICAgICAgICAgICAgdiA9IHtjb2x1bW5OYW1lOiBzcWxTdHJpbmd9XHJcbkBtZXRob2RzXHJcbiAgQG1ldGhvZCBsXHJcbiAgICBAcGFyYW0ge0FycmF5fSBrZXlzID0+IGFycmF5IG9mIHByaW1hcnkga2V5cyBpbiBvYmplY3RcclxuICAgIEBkbyBkZWxldGUgY3VycmVudCBvYmplY3QgZnJvbSBkYlxyXG4gICAgQHJldHVybiB7QXJyYXk8T2JqZWN0Pn0gPT4gYXJyYXkgb2Ygb2JqZWN0IGZyb20gZGJcclxuICBAbWV0aG9kIHNhdmVcclxuICAgIEBwYXJhbSB7QXJyYXk8T2JqZWN0Pn0gcmVjb3JkcyA9PiBhcnJheSBvZiBvYmplY3RzIHRvIHJlY29yZCBpbiBkYiwgd2hlcmUgbmFtZSBvZiB2YXJpYWJsZXMgaW4gb2JqZWN0cyBhcmUgZXF1YWwgdG8gY29sdW1uIG5hbWVzIGluIGRiXHJcbiAgICBAZG8gdXBkYXRlIGN1cnJlbnQgb2JqZWN0IHRvIGRiIGJ5IGl0cyBwcmltYXJ5IGtleSBvciBjcmVhdGUgbmV3IGluIGRiXHJcbiAgICBAcmV0dXJuIHJlY29yZHMgPT4gaWYgdGhlcmUgd2FzIG5ldyByZWNvcmQgaXQgc2V0IHByaW1hcnkga2V5IHRvIHJlY29yZC4gQWZ0ZXIgYWxsIGlzIHJldHVybiBpbiBuZXcgYXJyYXkgb2Ygb2JqZWN0LCB3aGljaCB3ZXJlIHBhc3NlZCB0byBtZXRob2RcclxuICBAbWV0aG9kIGRlbFxyXG4gICAgQHBhcmFtIHtBcnJheX0ga2V5cyA9PiBhcnJheSBvZiBwcmltYXJ5IGtleXMgaW4gb2JqZWN0XHJcbiAgICBAZG8gZGVsZXRlIGN1cnJlbnQgb2JqZWN0IGZyb20gZGJcclxuICBAbWV0aG9kIHNsXHJcbiAgICBAcGFyYW0ge1N0cmluZ30gd2hlcmUgPT4gd2hlcmUgc3FsIHF1ZXJ5LiBFeGFtcGxlIHdoZXJlID0gXCJpZCA9IDgsIG5hbWU9YFZhc2FgXCJcclxuICAgIEBwYXJhbSB7QXJyYXl9IGRhdGEgPT4gYXJyYXkgb2YgdmFsdWVzIHRvIHJlcGxhY2UgXCI/XCIgaW4gQHdoZXJlIHN0cmluZ1xyXG4gICAgQHJldHVybiB7QXJyYXk8T2JqZWN0Pn0gPT4gcmV0dXJuIHNlbGVjdGVkIG9iamVjdHMgZnJvbSBkYlxyXG5cclxuKi9cclxuY2xhc3MgVGFibGVTUUx7XHJcbiAgY29uc3RydWN0b3IoaywgdGFibGUsIHYpe1xyXG4gICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgIF90aGlzLmsgPSBrO1xyXG4gICAgX3RoaXMudGFibGUgPSB0YWJsZTtcclxuICAgIF90aGlzLnYgPSB2O1xyXG5cclxuICAgIHdlYnNxbC5wcm9jZXNzKGBDUkVBVEUgVEFCTEUgSUYgTk9UIEVYSVNUUyAke3RhYmxlfSgkeyhmdW5jdGlvbigpe1xyXG4gICAgICB2YXIgY29sdW1ucyA9IFwiXCJcclxuICAgICAgZm9yKHZhciBjIGluIHYpe1xyXG4gICAgICAgIGNvbHVtbnMgKz0gdltjXSArIFwiLFwiO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBjb2x1bW5zLnNsaWNlKDAsIC0xKTtcclxuICAgIH0pKCl9KWApO1xyXG5cclxuICB9XHJcblxyXG4gIGwoa2V5cywgY2Ipe1xyXG4gICAgbGV0IF90aGlzID0gdGhpcztcclxuICAgIHZhciByZWNvcmRzID0gW107XHJcbiAgICB2YXIgcHJvY2Vzc0RBVEEgPSBbXTtcclxuICAgIGZvcih2YXIgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSBpZihrZXlzW2ldKXtcclxuICAgICAgcHJvY2Vzc0RBVEFbcHJvY2Vzc0RBVEEubGVuZ3RoXSA9IHtcclxuICAgICAgICBcInNxbFwiOiBgU0VMRUNUICogRlJPTSAke190aGlzLnRhYmxlfSBXSEVSRSAke190aGlzLmt9IGluICgkeyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgdmFyIHIgPSBcIlwiO1xyXG4gICAgICAgICAgZm9yKHZhciBqID0gMDsgaiA8IGtleXMubGVuZ3RoOyBqKyspIHIgKz0gXCI/LFwiO1xyXG4gICAgICAgICAgcmV0dXJuIHIuc2xpY2UoMCwgLTEpO1xyXG4gICAgICAgIH0pKCl9KWAsXHJcbiAgICAgICAgXCJkYXRhXCI6IGtleXMsXHJcbiAgICAgICAgXCJzdWNjZXNzXCI6ICh0ciwgcikgPT4ge1xyXG4gICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHIucm93cy5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICAgIHZhciByb3cgPSByLnJvd3MuaXRlbShpKTtcclxuICAgICAgICAgICAgcmVjb3Jkc1tpXSA9IHt9O1xyXG4gICAgICAgICAgICBmb3IodmFyIGNvbCBpbiByb3cpe1xyXG4gICAgICAgICAgICAgIHJlY29yZHNbaV1bY29sXSA9IHJvd1tjb2xdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmKHByb2Nlc3NEQVRBLmxlbmd0aCA+IDApIHdlYnNxbC5wcm9jZXNzKHByb2Nlc3NEQVRBLCAoKSA9PiB7Y2IocmVjb3Jkcyl9KTtcclxuICAgIGVsc2UgY2IocmVjb3Jkcyk7XHJcbiAgfVxyXG5cclxuICBzYXZlKHJlY29yZHMsIGNiKXtcclxuICAgIHZhciBrID0gdGhpcy5rLCB0YWJsZSA9IHRoaXMudGFibGUsIHYgPSB0aGlzLnYsIGZvckkgPSBbXSwgY291bnRlciA9IDA7XHJcbiAgICB2YXIgcHJvY2Vzc0RBVEEgPSBbXTtcclxuXHJcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwgcmVjb3Jkcy5sZW5ndGg7IGkrKyl7XHJcbiAgICAgIGlmKHJlY29yZHNbaV0gJiYgIXJlY29yZHNbaV1ba10pe1xyXG4gICAgICAgIGZvcklbZm9ySS5sZW5ndGhdID0gaSAtIDE7XHJcbiAgICAgICAgcHJvY2Vzc0RBVEFbcHJvY2Vzc0RBVEEubGVuZ3RoXSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJzcWxcIjogYElOU0VSVCBJTlRPICR7dGFibGV9ICR7KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29scyA9IFwiKFwiLCB2YWxzID0gXCIoXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGMgaW4gdil7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGMgPT0gaykgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHMgKz0gYyArIFwiLFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxzICs9IFwiPyxcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHMgPSBjb2xzLnNsaWNlKDAsIC0xKSArIFwiKVwiLCB2YWxzID0gdmFscy5zbGljZSgwLCAtMSkgKyBcIilcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBgJHtjb2xzfSBWQUxVRVMgJHt2YWxzfWA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkoKX1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImRhdGFcIjogKGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdG9kYiA9IHJlY29yZHNbaV0udG9EQigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcih2YXIgYyBpbiB2KXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGMgPT0gaykgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByW3IubGVuZ3RoXSA9IHRvZGJbY107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1Y2Nlc3NcIjogKHRyLCByKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjb3Jkc1tmb3JJW2NvdW50ZXJdICsgMV1ba10gPSByLmluc2VydElkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ZXIrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgfWVsc2UgaWYocmVjb3Jkc1tpXSkgcHJvY2Vzc0RBVEFbcHJvY2Vzc0RBVEEubGVuZ3RoXSA9IHtcInNxbFwiOiBgVVBEQVRFICR7dGFibGV9IFNFVCAkeyhmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWxzID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGMgaW4gdil7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihjID09IGspIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYyAhPSBPYmplY3Qua2V5cyhrKVswXSkgdmFscyArPSBgJHtjfSA9ID8sYDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHMuc2xpY2UoMCwgLTEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSgpfSBXSEVSRSAke2t9ID0gJHtyZWNvcmRzW2ldW2tdfWAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGF0YVwiOiAoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0b2RiID0gcmVjb3Jkc1tpXS50b0RCKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBjIGluIHYpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYyA9PSBrKSBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJbci5sZW5ndGhdID0gdG9kYltjXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgaWYocHJvY2Vzc0RBVEEubGVuZ3RoID4gMCkgd2Vic3FsLnByb2Nlc3MocHJvY2Vzc0RBVEEsICgpID0+IHtjYihyZWNvcmRzKX0pO1xyXG4gICAgZWxzZSBjYihyZWNvcmRzKTtcclxuICB9XHJcblxyXG4gIGRlbChrZXlzKXtcclxuICAgIGtleXMgPSBrZXlzLm1hcChrZXkgPT4gcGFyc2VJbnQoa2V5KSk7XHJcbiAgICB2YXIgayA9IHRoaXMuaywgdGFibGUgPSB0aGlzLnRhYmxlO1xyXG4gICAgXHJcbiAgICBmb3IodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgaWYoa2V5c1tpXSkgd2Vic3FsLnByb2Nlc3Moe1xyXG4gICAgICBcInNxbFwiOiBgREVMRVRFIEZST00gJHt0YWJsZX0gV0hFUkUgJHtrfSA9ID9gLFxyXG4gICAgICBcImRhdGFcIjogW2tleXNbaV1dXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNsKHdoZXJlLCBkYXRhLCBjYil7XHJcbiAgICB2YXIgcmVjb3JkcyA9IFtdLCBmb3JJID0gW10sIGNvdW50ZXIgPSAwO1xyXG4gICAgd2Vic3FsLnByb2Nlc3Moe1xyXG4gICAgICBcInNxbFwiOiBgU0VMRUNUICogRlJPTSAke3RoaXMudGFibGV9IFdIRVJFICR7d2hlcmV9YCxcclxuICAgICAgXCJkYXRhXCI6IGRhdGEsXHJcbiAgICAgIFwic3VjY2Vzc1wiOiAodHIsIHIpID0+IHtcclxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgci5yb3dzLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgIHZhciByb3cgPSByLnJvd3MuaXRlbShpKTtcclxuICAgICAgICAgIHJlY29yZHNbaV0gPSBbXTtcclxuICAgICAgICAgIGZvcih2YXIgY29sIGluIHJvdyl7XHJcbiAgICAgICAgICAgIHJlY29yZHNbaV1bY29sXSA9IHJvd1tjb2xdO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSwgKCkgPT4gY2IocmVjb3JkcykpO1xyXG4gIH1cclxufVxyXG4iXX0=
